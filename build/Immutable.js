(function(){"use strict";function t(t){return"string"==typeof t&&dn.test(t)}function r(t){var r=typeof t;return"symbol"===r||"string"===r&&(wn.test(t)||mn.test(t))}function n(t){return"string"==typeof t&&mn.test(t)}function e(){if(0===arguments.length)return"(Tag "+yn+" "+ ++vn+")";throw Error("Expected 0 arguments but got "+arguments.length)}function o(r){if(1===arguments.length){if(t(r))return"(UUIDTag "+r+")";throw Error("Expected a lower-case UUID, but got: "+r)}throw Error("Expected 1 argument but got "+arguments.length)}function i(t){for(var r=t.length,n=Array(r),e=0;r>e;++e)n[e]=t[e];return n}function u(t,r,n){for(var e=t.length+1,o=Array(e),i=0;r>i;)o[i]=t[i],++i;for(o[i]=n,++i;e>i;)o[i]=t[i-1],++i;return o}function f(t,r,n){var e=t[r],o=n(e);if(e===o)return t;var u=i(t);return u[r]=o,u}function s(t,r){for(var n=t.length-1,e=Array(n),o=0;r>o;)e[o]=t[o],++o;for(;n>o;)e[o]=t[o+1],++o;return e}function a(t){var r=0;return{next:function(){return r<t.length?{value:t[r++]}:{done:!0}}}}function h(t){return F(t)?null!=t[xn]||null!==bn&&t[bn]||Array.isArray(t):"string"==typeof t&&!r(t)}function c(t){var n;if(null!=(n=t[xn]))return n.call(t);if(null!==bn&&null!=(n=t[bn]))return n.call(t);if(Array.isArray(t))return a(t);if("string"!=typeof t||r(t))throw Error("Cannot iter: "+t);return a(t)}function p(t){var r={};return r[xn]=t,null!==bn&&(r[bn]=t),r}function l(t,r){for(;;){var n=t.next();if(n.done)break;r(n.value)}}function y(t,r){return{next:function(){var n=t.next();return n.done?{done:!0}:{value:r(n.value)}}}}function v(t,r){var n=!1,e=!1;return{next:function(){for(;;)if(n){if(e)return{done:!0};var o=r.next();if(!o.done)return o;e=!0}else{var o=t.next();if(!o.done)return o;n=!0}}}}function g(t,r){var n=2===arguments.length;return p(function(){var e=b(t).map(function(t){return c(t)}),o=!1;return{next:function(){for(;;){if(o)return{done:!0};for(var t=[],i=!1,u=0,f=e.length;f>u;++u){var s=e[u].next();if(s.done){if(!n){i=!1;break}t.push(r)}else i=!0,t.push(s.value)}if(i)return{value:$(t)};o=!0}}}})}function d(t){var r=[];l(t,function(t){r.push(t)});var n=r.length;return{next:function(){return n?{value:r[--n]}:{done:!0}}}}function w(t,r,n){return z(t,function(t){r=n(r,t)}),r}function m(t,r,n){return w(A(t),r,function(t,r){return n(r,t)})}function b(t){if(Array.isArray(t))return t;var r=[];return z(t,function(t){r.push(t)}),r}function E(t,r){return null==r&&(r=""),"string"==typeof t&&""===r?t:b(t).join(r)}function x(t,r){var n=!1,e=null;return{next:function(){for(;;){if(n)return{done:!0};if(null===e){var o=t.next();o.done?n=!0:e=r(o.value)}else{var o=e.next();if(!o.done)return o;e=null}}}}}function k(t){return B(t)?_(Object.keys(t),function(r){return[r,t[r]]}):t}function z(t,r){l(c(t),r)}function S(t,r,n){for(var e=c(t),o=0;;){var i=e.next();if(i.done){if(3===arguments.length)return n;throw Error("findIndex did not find anything")}if(r(i.value))return o;++o}}function _(t,r){return p(function(){return y(c(t),r)})}function A(t){return p(function(){return d(c(t))})}function I(t,r){return p(function(){var n=c(t);return{next:function(){for(;;){var t=n.next();if(t.done)return{done:!0};if(r(t.value))return t}}}})}function O(t){if(F(t)){var e=t[zn];if(null!=e){var o=_n[e];if(null!=o)return o(t);throw Error("Cannot handle type "+e)}return t}if(r(t)){if(n(t))return t;throw Error("Cannot convert Tag from JSON, use UUIDTag instead: "+t)}return t}function T(t){if(F(t)){var e=t[Sn];return null!=e?e(t):t}if(r(t)){if(n(t))return t;throw Error("Cannot convert Tag to JSON, use UUIDTag instead: "+t)}return t}function j(t,r){var n={};return n[zn]=t,n.keys=[],n.values=[],z(r,function(t){X(t,function(t,r){n.keys.push(T(t)),n.values.push(T(r))})}),n}function D(t,r){var n={};return n[zn]=t,n.values=[],z(r,function(t){n.values.push(T(t))}),n}function U(t){for(var r=t.keys,n=t.values,e=r.length,o=Array(e),i=0;e>i;++i)o[i]=[O(r[i]),O(n[i])];return o}function C(t){for(var r=t.values,n=r.length,e=Array(n),o=0;n>o;++o)e[o]=O(r[o]);return e}function R(t){if(F(t)){var r=t[kn];return null!=r?r(t):t}return t}function J(t){var r={};return z(t,function(t){X(t,function(t,n){if("string"!=typeof t)throw Error("Cannot convert to JavaScript: expected key to be string or Tag but got "+t);r[t]=R(n)})}),r}function N(t){var r=[];return z(t,function(t){r.push(R(t))}),r}function L(){return Z(this)}function M(t,r){return t>=0&&r>t}function Q(t){var r=this.size();return 0>t&&(t+=r),M(t,r)}function K(t){this.values=t,this.hash=null}function q(t){return t instanceof K}function $(t){return new K(t)}function P(t){if(null!=t){if(q(t))return t;var r=[];return z(t,function(t){r.push(t)}),new K(r)}return new K([])}function F(t){return Object(t)===t}function B(t){if(F(t)){var r=Object.getPrototypeOf(t);return null===r||r===Object.prototype}return!1}function G(t,r){return Array(r+1).join(t)}function H(t,r,n){var e=Math.max(0,r-t.length);return t+G(n,e)}function V(t){return t}function W(t,r){return 1===t?r:r+"s"}function X(t,r){if(Array.isArray(t)){if(2===t.length)return r(t[0],t[1]);throw Error("Expected array with 2 elements but got "+t.length+" "+W(t.length,"element"))}if(q(t)){if(2===t.size())return r(t.get(0),t.get(1));throw Error("Expected Tuple with 2 elements but got "+t.size()+" "+W(t.size(),"element"))}throw Error("Expected array or Tuple but got: "+t)}function Y(t){return'"'+t.replace(/[\\\"\n]/g,function(t){return"\n"===t?t+" ":"\\"+t})+'"'}function Z(t){var n=typeof t;if("string"===n)return r(t)?t:Y(t);if("number"===n||"boolean"===n||"undefined"===n||null===t)return""+t;var e=t[En];if(null!=e)return e(t);var o="(Mutable "+ ++Tn+")";return Object.defineProperty(t,En,{configurable:!1,enumerable:!1,writable:!1,value:function(){return o}}),o}function tr(t,r){var n=0,e=[];z(t,function(t){X(t,function(t,r){t=Z(t),r=Z(r),t=t.split(/\n/),z(t,function(t){n=Math.max(n,t.length)}),e.push({key:t,value:r})})});var r="  ";return e=_(e,function(t){var r=t.key.length-1;t.key[r]=H(t.key[r],n," ");var e=E(t.key,"\n"),o=t.value.replace(/\n/g,"\n"+G(" ",n+3));return e+" = "+o}),nr(e,r)}function rr(t){return function(r){if(null===r.hash){var n=_(r,function(t){return Z(t)});r.hash="("+t+nr(n,"  ")+")"}return r.hash}}function nr(t,r){var n="\n"+r;return E(_(t,function(t){return n+t.replace(/\n/g,n)}))}function er(t,r){return t>r?t:r}function or(t,r,n){var e=r.depth,o=n.depth;if(e>o+1){var i=r.left,u=r.right;return u.depth>i.depth?u.copy(r.copy(i,u.left),t.copy(u.right,n)):r.copy(i,t.copy(u,n))}if(o>e+1){var f=n.right,s=n.left;return s.depth>f.depth?s.copy(t.copy(r,s.left),n.copy(s.right,f)):n.copy(t.copy(r,s),f)}return t.copy(r,n)}function ir(t,r){if(t===An)return r;if(r===An)return t;if(t.depth<r.depth){var n=ir(t,r.left);return or(r,n,r.right)}var e=ir(t.right,r);return or(t,t.left,e)}function ur(t,r){return t===An?r:or(t,ur(t.left,r),t.right)}function fr(t,r){return t===An?r:or(t,t.left,fr(t.right,r))}function sr(t){for(var r=[];t!==An;)r.push(t),t=t.left;return{next:function(){if(r.length){var n=r.pop();for(t=n.right;t!==An;)r.push(t),t=t.left;return{value:n}}return{done:!0}}}}function ar(t,r){return t===r?0:r>t?-1:1}function hr(t,r,n){for(;t!==An;){var e=r(n,t.hash);if(0===e)break;t=0>e?t.left:t.right}return t}function cr(t,r,n,e){if(t===An)return e;var o=t.left,i=t.right,u=r(n,t.hash);if(0===u)return t.modify(e);if(0>u){var f=cr(o,r,n,e);return f===o?t:or(t,f,i)}var f=cr(i,r,n,e);return f===i?t:or(t,o,f)}function pr(t,r,n,e,o){if(t===An)throw Error("Key "+e+" not found");var i=t.left,u=t.right,f=r(n,t.hash);if(0===f)return t.modify({key:e,hash:n,value:o(t.value)});if(0>f){var s=pr(i,r,n,e,o);return s===i?t:or(t,s,u)}var s=pr(u,r,n,e,o);return s===u?t:or(t,i,s)}function lr(t,r,n){if(t===An)return t;var e=t.left,o=t.right,i=r(n,t.hash);if(0===i)return ir(e,o);if(0>i){var u=lr(e,r,n);return u===e?t:or(t,u,o)}var u=lr(o,r,n);return u===o?t:or(t,e,u)}function yr(){return this.root===An}function vr(t){return hr(this.root,this.sort,this.hash_fn(t))!==An}function gr(t){return function(r){var n=this.root,e=this.sort,o=this.hash_fn,i=lr(n,e,o(r));return i===n?this:new t(i,e,o)}}function dr(t){return w(k(t),this,function(t,r){return X(r,function(r,n){return t.set(r,n)})})}function wr(){return this.len}function mr(t){return w(t,this,function(t,r){return t.push(r)})}function br(t,r,n,e,o){this.left=t,this.right=r,this.hash=n,this.key=e,this.value=o,this.depth=er(t.depth,r.depth)+1}function Er(t,r,n){this.root=t,this.sort=r,this.hash_fn=n,this.hash=null}function xr(t){return t instanceof Er}function kr(t){return xr(t)&&t.hash_fn===V}function zr(t,r){return null!=r?kr(r)&&r.sort===t?r:new Er(An,t,V).merge(r):new Er(An,t,V)}function Sr(t){return null!=t?xr(t)&&!kr(t)?t:new Er(An,ar,Z).merge(t):new Er(An,ar,Z)}function _r(t,r,n,e){this.left=t,this.right=r,this.hash=n,this.key=e,this.depth=er(t.depth,r.depth)+1}function Ar(t,r,n){this.root=t,this.sort=r,this.hash_fn=n,this.hash=null}function Ir(t){return t instanceof Ar}function Or(t){return Ir(t)&&t.hash_fn===V}function Tr(t,r){return null!=r?Or(r)&&r.sort===t?r:new Ar(An,t,V).union(r):new Ar(An,t,V)}function jr(t){return null!=t?Ir(t)&&!Or(t)?t:new Ar(An,ar,Z).union(t):new Ar(An,ar,Z)}function Dr(t,r){this.car=t,this.cdr=r}function Ur(t){return{next:function(){if(t===An)return{done:!0};var r=t.car;return t=t.cdr,{value:r}}}}function Cr(t,r){for(;t!==An;)r(t.car),t=t.cdr}function Rr(t,r){if(t.length){var n=t[t.length-1];n.length+r.length<=jn?t[t.length-1]=n.concat(r):t.push(r)}else t.push(r)}function Jr(t,r,n){if(n>r){var e=Un((r+n)/2),o=Jr(t,r,e),i=Jr(t,e+1,n);return new Kr(o,i,t[e])}return An}function Nr(t){return Jr(t,0,t.length)}function Lr(t,r,n){0>r&&(r=0);var e=t.length;return n>e&&(n=e),0===r&&n===e?t:t.slice(r,n)}function Mr(t,r){for(var n=Array(r);r--;)n[r]=t.car,t=t.cdr;return n}function Qr(t,r,n){for(;--r!==n;)t=t.cdr;return t.car}function Kr(t,r,n){this.left=t,this.right=r,this.array=n,this.size=t.size+r.size+n.length,this.depth=er(t.depth,r.depth)+1}function qr(t,r){for(;;){var n=t.left,e=n.size;if(e>r)t=n;else{r-=e;var o=t.array,i=o.length;if(i>r)return o[r];r-=i,t=t.right}}}function $r(t,r,n){if(t===An)return new Kr(An,An,[n]);var e=t.left,o=t.right,i=e.size;if(i>r){var f=$r(e,r,n);return or(t,f,o)}r-=i;var s=t.array,a=s.length;if(a>=r){if(s=u(s,r,n),a===jn){var h=Dn(s.length/2),c=s.slice(0,h),p=s.slice(h);return e.depth<o.depth?new Kr(fr(e,new Kr(An,An,c)),o,p):new Kr(e,ur(o,new Kr(An,An,p)),c)}return new Kr(e,o,s)}var f=$r(o,r-a,n);return or(t,e,f)}function Pr(t,r,n){var e=t.left,o=t.right,i=e.size;if(i>r){var u=Pr(e,r,n);return u===e?t:t.copy(u,o)}r-=i;var s=t.array,a=s.length;if(a>r){var h=f(s,r,n);return h===s?t:new Kr(e,o,h)}var u=Pr(o,r-a,n);return u===o?t:t.copy(e,u)}function Fr(t,r){var n=t.left,e=t.right,o=n.size;if(o>r){var i=Fr(n,r);return or(t,i,e)}r-=o;var u=t.array,f=u.length;if(f>r)return u=s(u,r),0===u.length?ir(n,e):new Kr(n,e,u);var i=Fr(e,r-f);return or(t,n,i)}function Br(t,r,n,e){if(r!==An){var o=r.left,i=o.size;i>n&&Br(t,o,n,e);var u=r.array,f=u.length;n-=i,e-=i,f>n&&e>0&&Rr(t,Lr(u,n,e)),e>f&&Br(t,r.right,n-f,e-f)}}function Gr(t,r,n){this.root=t,this.tail=r,this.tail_size=n,this.hash=null}function Hr(t){return t instanceof Gr}function Vr(t){return null!=t?t instanceof Gr?t:new Gr(An,An,0).concat(t):new Gr(An,An,0)}function Wr(t,r,n){this.left=t,this.right=r,this.len=n,this.hash=null}function Xr(t){return t instanceof Wr}function Yr(t){return null!=t?t instanceof Wr?t:new Wr(An,An,0).concat(t):new Wr(An,An,0)}function Zr(t,r){this.root=t,this.len=r,this.hash=null}function tn(t){return t instanceof Zr}function rn(t){return null!=t?t instanceof Zr?t:new Zr(An,0).concat(t):new Zr(An,0)}function nn(t){if("string"!=typeof t)throw Error("Expected key to be a string or Tag but got "+t)}function en(t,r){this.keys=t,this.values=r,this.hash=null}function on(t){return t instanceof en}function un(t){var r={},n=[];if(null!=t){if(on(t))return t;z(k(t),function(t){X(t,function(t,e){nn(t),r[t]=n.push(e)-1})})}return new en(r,n)}function fn(t,r){this._id=++Cn,this._value=t,this._onchange=r}function sn(t){return an(t)?t.get():t}function an(t){return t instanceof fn}function hn(t,r){if(arguments.length<1||arguments.length>2)throw Error("Expected 1 to 2 arguments but got "+arguments.length);return new fn(t,r)}function cn(t,r){return t===r||Z(t)===Z(r)}function pn(t){if(F(t))return Object.isFrozen(t)||xr(t)||Ir(t)||Hr(t)||q(t)||Xr(t)||tn(t)||on(t);var r=typeof t;return"string"===r||"number"===r||"boolean"===r||"symbol"===r||null==t}function ln(t){if(Array.isArray(t)){for(var r=Vr(),n=0,e=t.length;e>n;++n)r=r.insert(ln(t[n]));return r}if(B(t)){var r=Sr();for(var o in t)r=r.set(o,ln(t[o]));return r}return t}var yn="48de6fff-9d11-472d-a76f-ed77a59a5cbc",vn=0,gn="[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}",dn=RegExp("^"+gn+"$"),wn=RegExp("^\\(Tag "+yn+" [0-9]+\\)$"),mn=RegExp("^\\(UUIDTag "+gn+"\\)$"),bn="undefined"!=typeof Symbol&&void 0!==Symbol.iterator?Symbol.iterator:null,En=o("e1c3818d-4c4f-4703-980a-00969e4ca900"),xn=o("6199065c-b518-4cb3-8b41-ab70a9769ec3"),kn=o("1b75a273-16bd-4248-be8a-e4b5e8c4b523"),zn=o("89d8297c-d95e-4ce9-bc9b-6b6f73fa6a37"),Sn=o("99e14916-bc99-4c48-81aa-299cf1ad6de3"),_n={},An={};An.depth=0,An.size=0;var In={},On={};In.toString=On.toString=L,In.inspect=On.inspect=L,null!==bn&&(In[bn]=On[bn]=function(){return c(this)}),K.prototype=Object.create(On),K.prototype[En]=rr("Tuple"),K.prototype[kn]=N,_n.Tuple=function(t){return P(C(t))},K.prototype[Sn]=function(t){return D("Tuple",t)},K.prototype[xn]=function(){return c(this.values)},K.prototype.size=function(){return this.values.length},K.prototype.get=function(t){var r=this.size();if(M(t,r))return this.values[t];throw Error("Index "+t+" is not valid")},K.prototype.modify=function(t,r){var n=this.size();if(M(t,n)){var e=this.values,o=f(e,t,r);return o===e?this:new K(o)}throw Error("Index "+t+" is not valid")};var Tn=0;br.prototype.copy=function(t,r){return new br(t,r,this.hash,this.key,this.value)},br.prototype.modify=function(t){var r=t.hash,n=t.key,e=t.value;return this.hash===r&&this.key===n&&this.value===e?this:new br(this.left,this.right,r,n,e)},Er.prototype=Object.create(On),Er.prototype[kn]=J,Er.prototype.isEmpty=yr,Er.prototype.has=vr,Er.prototype.remove=gr(Er),Er.prototype.merge=dr,Er.prototype[xn]=function(){return y(sr(this.root),function(t){return $([t.key,t.value])})},Er.prototype[En]=function(t){return null===t.hash&&(t.hash=xr(t)&&!kr(t)?"(Dict"+tr(t,"  ")+")":"(SortedDict "+Z(t.sort)+tr(t,"  ")+")"),t.hash},_n.Dict=function(t){return Sr(U(t))},Er.prototype[Sn]=function(t){if(xr(t)&&!kr(t))return j("Dict",t);throw Error("Cannot convert SortedDict to JSON")},Er.prototype.removeAll=function(){return new Er(An,this.sort,this.hash_fn)},Er.prototype.get=function(t,r){var n=hr(this.root,this.sort,this.hash_fn(t));if(n===An){if(2===arguments.length)return r;throw Error("Key "+t+" not found")}return n.value},Er.prototype.set=function(t,r){var n=this.root,e=this.sort,o=this.hash_fn,i=o(t),u=cr(n,e,i,new br(An,An,i,t,r));return u===n?this:new Er(u,e,o)},Er.prototype.modify=function(t,r){var n=this.root,e=this.sort,o=this.hash_fn,i=pr(n,e,o(t),t,r);return i===n?this:new Er(i,e,o)},_r.prototype.copy=function(t,r){return new _r(t,r,this.hash,this.key)},_r.prototype.modify=function(t){var r=t.hash,n=t.key;return this.hash===r&&this.key===n?this:new _r(this.left,this.right,r,n)},Ar.prototype=Object.create(On),Ar.prototype[kn]=N,Ar.prototype.isEmpty=yr,Ar.prototype.has=vr,Ar.prototype.remove=gr(Ar),_n.Set=function(t){return jr(C(t))},Ar.prototype[xn]=function(){return y(sr(this.root),function(t){return t.key})},Ar.prototype[Sn]=function(t){if(Ir(t)&&!Or(t))return D("Set",t);throw Error("Cannot convert SortedSet to JSON")},Ar.prototype[En]=function(t){if(null===t.hash){var r=_(t,function(t){return Z(t)}),n="  ";t.hash=Ir(t)&&!Or(t)?"(Set"+nr(r,n)+")":"(SortedSet "+Z(t.sort)+nr(r,n)+")"}return t.hash},Ar.prototype.removeAll=function(){return new Ar(An,this.sort,this.hash_fn)},Ar.prototype.add=function(t){var r=this.root,n=this.sort,e=this.hash_fn,o=e(t),i=cr(r,n,o,new _r(An,An,o,t));return i===r?this:new Ar(i,n,e)},Ar.prototype.union=function(t){return w(t,this,function(t,r){return t.add(r)})},Ar.prototype.intersect=function(t){var r=this;if(r.isEmpty())return r;var n=r.removeAll();return w(t,n,function(t,n){return r.has(n)?t.add(n):t})},Ar.prototype.disjoint=function(t){var r=this;return w(t,r,function(t,n){return r.has(n)?t.remove(n):t.add(n)})},Ar.prototype.subtract=function(t){return this.isEmpty()?this:w(t,this,function(t,r){return t.remove(r)})};var jn=125,Dn=Math.ceil,Un=Math.floor;Kr.prototype.copy=function(t,r){return new Kr(t,r,this.array)},Gr.prototype=Object.create(On),Gr.prototype[En]=rr("List"),Gr.prototype[kn]=N,Gr.prototype.has=Q,_n.List=function(t){return Vr(C(t))},Gr.prototype[Sn]=function(t){return D("List",t)},Gr.prototype[xn]=function(){var t=x(sr(this.root),function(t){return c(t.array)});return v(t,d(Ur(this.tail)))},Gr.prototype.isEmpty=function(){return this.root===An&&this.tail===An},Gr.prototype.removeAll=function(){return new Gr(An,An,0)},Gr.prototype.size=function(){return this.root.size+this.tail_size},Gr.prototype.get=function(t,r){var n=this.size();if(0>t&&(t+=n),M(t,n)){var e=this.root,o=e.size;return o>t?qr(e,t):Qr(this.tail,this.tail_size,t-o)}if(2===arguments.length)return r;throw Error("Index "+t+" is not valid")},Gr.prototype.insert=function(t,r){1===arguments.length&&(r=-1);var n=this.size();0>r&&(r+=n+1);var e=this.root,o=this.tail,i=this.tail_size;if(r===n){if(i===jn){var f=fr(e,new Kr(An,An,Mr(o,i)));return new Gr(f,new Dr(t,An),1)}return new Gr(e,new Dr(t,o),i+1)}if(M(r,n)){var s=e.size;if(s>r)return new Gr($r(e,r,t),o,i);var a=u(Mr(o,i),r-s,t),f=fr(e,new Kr(An,An,a));return new Gr(f,An,0)}throw Error("Index "+r+" is not valid")},Gr.prototype.remove=function(t){0===arguments.length&&(t=-1);var r=this.size();0>t&&(t+=r);var n=this.root,e=this.tail,o=this.tail_size;if(e!==An&&t===r-1)return new Gr(n,e.cdr,o-1);if(M(t,r)){var i=n.size;if(i>t)return new Gr(Fr(n,t),e,o);var u=s(Mr(e,o),t-i),f=fr(n,new Kr(An,An,u));return new Gr(f,An,0)}throw Error("Index "+t+" is not valid")},Gr.prototype.modify=function(t,r){var n=this.size();if(0>t&&(t+=n),M(t,n)){var e=this.root,o=this.tail,i=this.tail_size,u=e.size;if(o!==An&&t===n-1){var s=r(o.car);return s===o.car?this:new Gr(e,new Dr(s,o.cdr),i)}if(u>t){var a=Pr(e,t,r);return a===e?this:new Gr(a,o,i)}var h=Mr(o,i),c=f(h,t-u,r);if(c===h)return this;var a=fr(e,new Kr(An,An,c));return new Gr(a,An,0)}throw Error("Index "+t+" is not valid")},Gr.prototype.slice=function(t,r){var n=this.size();if(null==t&&(t=0),null==r&&(r=n),0>t&&(t+=n),0>r&&(r+=n),0===t&&r===n)return this;if(t>r)throw Error("Index "+t+" is greater than index "+r);if(M(t,n)){if(t===r)return new Gr(An,An,0);if(r>0&&n>=r){var e=this.root,o=e.size,i=[];if(o>=t&&Br(i,e,t,r),r>o){var u=Mr(this.tail,this.tail_size);Rr(i,Lr(u,t-o,r-o))}return new Gr(Nr(i),An,0)}throw Error("Index "+r+" is not valid")}throw Error("Index "+t+" is not valid")},Gr.prototype.concat=function(t){if(t instanceof Gr){var r=this.root,n=this.tail,e=t.root,o=t.tail;if(e===An&&o===An)return this;if(r===An&&n===An)return t;n!==An&&(r=fr(r,new Kr(An,An,Mr(n,this.tail_size))));var i=ir(r,e);return new Gr(i,o,t.tail_size)}return w(t,this,function(t,r){return t.insert(r)})},Wr.prototype=Object.create(On),Wr.prototype[kn]=N,Wr.prototype[En]=rr("Queue"),Wr.prototype.size=wr,Wr.prototype.concat=mr,_n.Queue=function(t){return Yr(C(t))},Wr.prototype[Sn]=function(t){return D("Queue",t)},Wr.prototype.isEmpty=function(){return this.left===An&&this.right===An},Wr.prototype.removeAll=function(){return new Wr(An,An,0)},Wr.prototype[xn]=function(){return v(Ur(this.left),d(Ur(this.right)))},Wr.prototype.peek=function(t){if(this.isEmpty()){if(1===arguments.length)return t;throw Error("Cannot peek from an empty queue")}return this.left.car},Wr.prototype.push=function(t){return this.isEmpty()?new Wr(new Dr(t,this.left),this.right,this.len+1):new Wr(this.left,new Dr(t,this.right),this.len+1)},Wr.prototype.pop=function(){if(this.isEmpty())throw Error("Cannot pop from an empty queue");var t=this.left.cdr;if(t===An){var r=An;return Cr(this.right,function(t){r=new Dr(t,r)}),new Wr(r,An,this.len-1)}return new Wr(t,this.right,this.len-1)},Zr.prototype=Object.create(On),Zr.prototype[kn]=N,Zr.prototype[En]=rr("Stack"),Zr.prototype.isEmpty=yr,Zr.prototype.size=wr,Zr.prototype.concat=mr,_n.Stack=function(t){return rn(C(t))},Zr.prototype[xn]=function(){return d(Ur(this.root))},Zr.prototype[Sn]=function(t){return D("Stack",t)},Zr.prototype.removeAll=function(){return new Zr(An,0)},Zr.prototype.peek=function(t){if(this.isEmpty()){if(1===arguments.length)return t;throw Error("Cannot peek from an empty stack")}return this.root.car},Zr.prototype.push=function(t){return new Zr(new Dr(t,this.root),this.len+1)},Zr.prototype.pop=function(){if(this.isEmpty())throw Error("Cannot pop from an empty stack");return new Zr(this.root.cdr,this.len-1)},en.prototype=Object.create(On),en.prototype.update=dr,en.prototype[kn]=J,_n.Record=function(t){return un(U(t))},en.prototype[Sn]=function(t){return j("Record",t)},en.prototype[En]=function(t){return null===t.hash&&(t.hash="(Record"+tr(t,"  ")+")"),t.hash},en.prototype[xn]=function(){var t=this.keys,r=this.values;return c(_(k(t),function(t){return X(t,function(t,n){return $([t,r[n]])})}))},en.prototype.get=function(t){nn(t);var r=this.keys[t];if(null==r)throw Error("Key "+t+" not found");return this.values[r]},en.prototype.set=function(t,r){return this.modify(t,function(){return r})},en.prototype.modify=function(t,r){nn(t);var n=this.keys,e=n[t];if(null==e)throw Error("Key "+t+" not found");var o=this.values,i=f(o,e,r);return i===o?this:new en(n,i)};var Cn=0;fn.prototype=Object.create(In),fn.prototype[En]=function(t){return"(Ref "+Z(t._id)+")"},fn.prototype.get=function(){return this._value},fn.prototype.set=function(t){var r=this._value;t!==r&&(this._value=t,null!=this._onchange&&this._onchange(r,t))},fn.prototype.modify=function(t){this.set(t(this.get()))},function(t,r){"function"==typeof define&&define.amd?define(["exports"],r):"object"==typeof exports?r(exports):(t.Immutable={},r(t.Immutable))}(this,function(t){t.equal=cn,t.fromJS=ln,t.toJS=R,t.isDict=xr,t.isSet=Ir,t.isSortedDict=kr,t.isSortedSet=Or,t.isList=Hr,t.isQueue=Xr,t.isTuple=q,t.isStack=tn,t.isImmutable=pn,t.SortedDict=zr,t.SortedSet=Tr,t.isIterable=h,t.Dict=Sr,t.Set=jr,t.List=Vr,t.Tuple=P,t.Queue=Yr,t.Stack=rn,t.simpleSort=ar,t.isRecord=on,t.Record=un,t.toJSON=T,t.fromJSON=O,t.deref=sn,t.Ref=hn,t.isRef=an,t.isTag=r,t.isUUIDTag=n,t.Tag=e,t.UUIDTag=o,t.each=z,t.map=_,t.keep=I,t.findIndex=S,t.reverse=A,t.foldl=w,t.foldr=m,t.join=E,t.zip=g,t.toArray=b})}).call(this);