(function(){"use strict";function t(t){return"string"==typeof t&&En.test(t)}function r(t){var r=typeof t;return"symbol"===r||"string"===r&&(xn.test(t)||kn.test(t))}function n(t){return"string"==typeof t&&kn.test(t)}function e(){if(0===arguments.length)return"(Tag "+wn+" "+ ++mn+")";throw Error("Expected 0 arguments but got "+arguments.length)}function i(r){if(1===arguments.length){if(t(r))return"(UUIDTag "+r+")";throw Error("Expected a lower-case UUID, but got: "+r)}throw Error("Expected 1 argument but got "+arguments.length)}function o(t){for(var r=t.length,n=Array(r),e=0;r>e;++e)n[e]=t[e];return n}function u(t,r,n){for(var e=t.length+1,i=Array(e),o=0;r>o;)i[o]=t[o],++o;for(i[o]=n,++o;e>o;)i[o]=t[o-1],++o;return i}function f(t,r,n){var e=t[r],i=n(e);if(e===i)return t;var u=o(t);return u[r]=i,u}function a(t,r){for(var n=t.length-1,e=Array(n),i=0;r>i;)e[i]=t[i],++i;for(;n>i;)e[i]=t[i+1],++i;return e}function s(t){var r=0;return{next:function(){return r<t.length?{value:t[r++]}:{done:!0}}}}function h(t){return V(t)?null!=t[_n]||null!==zn&&t[zn]||Array.isArray(t):"string"==typeof t&&!r(t)}function c(t){var n;if(null!=(n=t[_n]))return n.call(t);if(null!==zn&&null!=(n=t[zn]))return n.call(t);if(Array.isArray(t))return s(t);if("string"!=typeof t||r(t))throw Error("Cannot iter: "+t);return s(t)}function l(t){var r={};return r[_n]=t,null!==zn&&(r[zn]=t),r}function p(t,r){for(;;){var n=t.next();if(n.done)break;r(n.value)}}function v(t,r){return{next:function(){var n=t.next();return n.done?{done:!0}:{value:r(n.value)}}}}function y(t,r){var n=!1,e=!1;return{next:function(){for(;;)if(n){if(e)return{done:!0};var i=r.next();if(!i.done)return{value:i.value};e=!0}else{var i=t.next();if(!i.done)return{value:i.value};n=!0}}}}function g(t,r){for(var n=c(t);;){var e=n.next();if(e.done)return!1;if(r(e.value))return!0}}function d(t,r){for(var n=c(t);;){var e=n.next();if(e.done)return!0;if(!r(e.value))return!1}}function w(t,r,n){for(var e=c(t);;){var i=e.next();if(i.done){if(3===arguments.length)return n;throw Error("Did not find anything")}if(r(i.value))return i.value}}function m(t,r){var n=[],e=[],i=Dn,o=!1;return G([l(function(){return i===Dn&&(i=c(t)),{next:function(){for(;;){if(n.length)return n.shift();if(o)return{done:!0};var t=i.next();if(t.done)o=!0;else{if(r(t.value))return{value:t.value};e.push({value:t.value})}}}}}),l(function(){return i===Dn&&(i=c(t)),{next:function(){for(;;){if(e.length)return e.shift();if(o)return{done:!0};var t=i.next();if(t.done)o=!0;else{if(!r(t.value))return{value:t.value};n.push({value:t.value})}}}}})])}function b(t,r){var n=2===arguments.length;return l(function(){var e=z(t).map(function(t){return c(t)}),i=!1;return{next:function(){for(;;){if(i)return{done:!0};for(var t=[],o=!1,u=0,f=e.length;f>u;++u){var a=e[u].next();if(a.done){if(!n){o=!1;break}t.push(r)}else o=!0,t.push(a.value)}if(o)return{value:G(t)};i=!0}}}})}function E(t){var r=[];p(t,function(t){r.push(t)});var n=r.length;return{next:function(){return n?{value:r[--n]}:{done:!0}}}}function x(t,r,n){return I(t,function(t){r=n(r,t)}),r}function k(t,r,n){return x(j(t),r,function(t,r){return n(r,t)})}function z(t){if(Array.isArray(t))return t;var r=[];return I(t,function(t){r.push(t)}),r}function S(t,r){return 1===arguments.length&&(r=""),"string"==typeof t&&""===r?t:z(t).join(r)}function _(t,r){var n=!1,e=Dn;return{next:function(){for(;;){if(n)return{done:!0};if(e===Dn){var i=t.next();i.done?n=!0:e=r(i.value)}else{var i=e.next();if(!i.done)return{value:i.value};e=Dn}}}}}function A(t){return W(t)?T(Object.keys(t),function(r){return[r,t[r]]}):t}function I(t,r){p(c(t),r)}function O(t,r,n){for(var e=c(t),i=0;;){var o=e.next();if(o.done){if(3===arguments.length)return n;throw Error("Did not find anything")}if(r(o.value))return i;++i}}function T(t,r){return l(function(){return v(c(t),r)})}function j(t){return l(function(){return E(c(t))})}function D(t,r){return l(function(){var n=c(t);return{next:function(){for(;;){var t=n.next();if(t.done)return{done:!0};if(r(t.value))return{value:t.value}}}}})}function U(t){if(V(t)){var e=t[In];if(null!=e){var i=Tn[e];if(null!=i)return i(t);throw Error("Cannot handle type "+e)}return t}if(r(t)){if(n(t))return t;throw Error("Cannot convert Tag from JSON, use UUIDTag instead: "+t)}return t}function C(t){if(V(t)){var e=t[On];return null!=e?e(t):t}if(r(t)){if(n(t))return t;throw Error("Cannot convert Tag to JSON, use UUIDTag instead: "+t)}return t}function R(t,r){var n={};return n[In]=t,n.keys=[],n.values=[],I(r,function(t){rr(t,function(t,r){n.keys.push(C(t)),n.values.push(C(r))})}),n}function J(t,r){var n={};return n[In]=t,n.values=[],I(r,function(t){n.values.push(C(t))}),n}function N(t){for(var r=t.keys,n=t.values,e=r.length,i=Array(e),o=0;e>o;++o)i[o]=[U(r[o]),U(n[o])];return i}function L(t){for(var r=t.values,n=r.length,e=Array(n),i=0;n>i;++i)e[i]=U(r[i]);return e}function M(t){if(V(t)){var r=t[An];return null!=r?r(t):t}return t}function Q(t){var r={};return I(t,function(t){rr(t,function(t,n){if("string"!=typeof t)throw Error("Cannot convert to JavaScript: expected key to be string or Tag but got "+t);r[t]=M(n)})}),r}function K(t){var r=[];return I(t,function(t){r.push(M(t))}),r}function q(){return er(this)}function $(t,r){return t>=0&&r>t}function P(t){var r=this.size();return 0>t&&(t+=r),$(t,r)}function F(t){this.values=t,this.hash=null}function B(t){return t instanceof F}function G(t){return new F(t)}function H(t){if(null!=t){if(B(t))return t;var r=[];return I(t,function(t){r.push(t)}),new F(r)}return new F([])}function V(t){return Object(t)===t}function W(t){if(V(t)){var r=Object.getPrototypeOf(t);return null===r||r===Object.prototype}return!1}function X(t,r){return Array(r+1).join(t)}function Y(t,r,n){var e=Math.max(0,r-t.length);return t+X(n,e)}function Z(t){return t}function tr(t,r){return 1===t?r:r+"s"}function rr(t,r){if(Array.isArray(t)){if(2===t.length)return r(t[0],t[1]);throw Error("Expected array with 2 elements but got "+t.length+" "+tr(t.length,"element"))}if(B(t)){if(2===t.size())return r(t.get(0),t.get(1));throw Error("Expected Tuple with 2 elements but got "+t.size()+" "+tr(t.size(),"element"))}throw Error("Expected array or Tuple but got: "+t)}function nr(t){return'"'+t.replace(/[\\\"\n]/g,function(t){return"\n"===t?t+" ":"\\"+t})+'"'}function er(t){var n=typeof t;if("string"===n)return r(t)?t:nr(t);if("number"===n||"boolean"===n||"undefined"===n||null===t)return""+t;var e=t[Sn];if(null!=e)return e(t);var i="(Mutable "+ ++Rn+")";return Object.defineProperty(t,Sn,{configurable:!1,enumerable:!1,writable:!1,value:function(){return i}}),i}function ir(t,r){var n=0,e=[];I(t,function(t){rr(t,function(t,r){t=er(t),r=er(r),t=t.split(/\n/),I(t,function(t){n=Math.max(n,t.length)}),e.push({key:t,value:r})})});var r="  ";return e=T(e,function(t){var r=t.key.length-1;t.key[r]=Y(t.key[r],n," ");var e=S(t.key,"\n"),i=t.value.replace(/\n/g,"\n"+X(" ",n+3));return e+" = "+i}),ur(e,r)}function or(t){return function(r){if(null===r.hash){var n=T(r,function(t){return er(t)});r.hash="("+t+ur(n,"  ")+")"}return r.hash}}function ur(t,r){var n="\n"+r;return S(T(t,function(t){return n+t.replace(/\n/g,n)}))}function fr(t,r){return t>r?t:r}function ar(t,r,n){var e=r.depth,i=n.depth;if(e>i+1){var o=r.left,u=r.right;return u.depth>o.depth?u.copy(r.copy(o,u.left),t.copy(u.right,n)):r.copy(o,t.copy(u,n))}if(i>e+1){var f=n.right,a=n.left;return a.depth>f.depth?a.copy(t.copy(r,a.left),n.copy(a.right,f)):n.copy(t.copy(r,a),f)}return t.copy(r,n)}function sr(t,r){if(t===jn)return r;if(r===jn)return t;if(t.depth<r.depth){var n=sr(t,r.left);return ar(r,n,r.right)}var e=sr(t.right,r);return ar(t,t.left,e)}function hr(t,r){return t===jn?r:ar(t,hr(t.left,r),t.right)}function cr(t,r){return t===jn?r:ar(t,t.left,cr(t.right,r))}function lr(t){for(var r=[];t!==jn;)r.push(t),t=t.left;return{next:function(){if(r.length){var n=r.pop();for(t=n.right;t!==jn;)r.push(t),t=t.left;return{value:n}}return{done:!0}}}}function pr(t,r){return t===r?0:r>t?-1:1}function vr(t,r,n){for(;t!==jn;){var e=r(n,t.hash);if(0===e)break;t=0>e?t.left:t.right}return t}function yr(t,r,n,e){if(t===jn)return e;var i=t.left,o=t.right,u=r(n,t.hash);if(0===u)return t.modify(e);if(0>u){var f=yr(i,r,n,e);return f===i?t:ar(t,f,o)}var f=yr(o,r,n,e);return f===o?t:ar(t,i,f)}function gr(t,r,n,e,i){if(t===jn)throw Error("Key "+e+" not found");var o=t.left,u=t.right,f=r(n,t.hash);if(0===f)return t.modify({key:e,hash:n,value:i(t.value)});if(0>f){var a=gr(o,r,n,e,i);return a===o?t:ar(t,a,u)}var a=gr(u,r,n,e,i);return a===u?t:ar(t,o,a)}function dr(t,r,n){if(t===jn)return t;var e=t.left,i=t.right,o=r(n,t.hash);if(0===o)return sr(e,i);if(0>o){var u=dr(e,r,n);return u===e?t:ar(t,u,i)}var u=dr(i,r,n);return u===i?t:ar(t,e,u)}function wr(){return this.root===jn}function mr(t){return vr(this.root,this.sort,this.hash_fn(t))!==jn}function br(t){return function(r){var n=this.root,e=this.sort,i=this.hash_fn,o=dr(n,e,i(r));return o===n?this:new t(o,e,i)}}function Er(t){return x(A(t),this,function(t,r){return rr(r,function(r,n){return t.set(r,n)})})}function xr(){return this.len}function kr(t){return x(t,this,function(t,r){return t.push(r)})}function zr(t,r,n,e,i){this.left=t,this.right=r,this.hash=n,this.key=e,this.value=i,this.depth=fr(t.depth,r.depth)+1}function Sr(t,r,n){this.root=t,this.sort=r,this.hash_fn=n,this.hash=null}function _r(t){return t instanceof Sr}function Ar(t){return _r(t)&&t.hash_fn===Z}function Ir(t,r){return null!=r?Ar(r)&&r.sort===t?r:new Sr(jn,t,Z).merge(r):new Sr(jn,t,Z)}function Or(t){return null!=t?_r(t)&&!Ar(t)?t:new Sr(jn,pr,er).merge(t):new Sr(jn,pr,er)}function Tr(t,r,n,e){this.left=t,this.right=r,this.hash=n,this.key=e,this.depth=fr(t.depth,r.depth)+1}function jr(t,r,n){this.root=t,this.sort=r,this.hash_fn=n,this.hash=null}function Dr(t){return t instanceof jr}function Ur(t){return Dr(t)&&t.hash_fn===Z}function Cr(t,r){return null!=r?Ur(r)&&r.sort===t?r:new jr(jn,t,Z).union(r):new jr(jn,t,Z)}function Rr(t){return null!=t?Dr(t)&&!Ur(t)?t:new jr(jn,pr,er).union(t):new jr(jn,pr,er)}function Jr(t,r){this.car=t,this.cdr=r}function Nr(t){return{next:function(){if(t===jn)return{done:!0};var r=t.car;return t=t.cdr,{value:r}}}}function Lr(t,r){for(;t!==jn;)r(t.car),t=t.cdr}function Mr(t,r){if(t.length){var n=t[t.length-1];n.length+r.length<=Jn?t[t.length-1]=n.concat(r):t.push(r)}else t.push(r)}function Qr(t,r,n){if(n>r){var e=Ln((r+n)/2),i=Qr(t,r,e),o=Qr(t,e+1,n);return new Fr(i,o,t[e])}return jn}function Kr(t){return Qr(t,0,t.length)}function qr(t,r,n){0>r&&(r=0);var e=t.length;return n>e&&(n=e),0===r&&n===e?t:t.slice(r,n)}function $r(t,r){for(var n=Array(r);r--;)n[r]=t.car,t=t.cdr;return n}function Pr(t,r,n){for(;--r!==n;)t=t.cdr;return t.car}function Fr(t,r,n){this.left=t,this.right=r,this.array=n,this.size=t.size+r.size+n.length,this.depth=fr(t.depth,r.depth)+1}function Br(t,r){for(;;){var n=t.left,e=n.size;if(e>r)t=n;else{r-=e;var i=t.array,o=i.length;if(o>r)return i[r];r-=o,t=t.right}}}function Gr(t,r,n){if(t===jn)return new Fr(jn,jn,[n]);var e=t.left,i=t.right,o=e.size;if(o>r){var f=Gr(e,r,n);return ar(t,f,i)}r-=o;var a=t.array,s=a.length;if(s>=r){if(a=u(a,r,n),s===Jn){var h=Nn(a.length/2),c=a.slice(0,h),l=a.slice(h);return e.depth<i.depth?new Fr(cr(e,new Fr(jn,jn,c)),i,l):new Fr(e,hr(i,new Fr(jn,jn,l)),c)}return new Fr(e,i,a)}var f=Gr(i,r-s,n);return ar(t,e,f)}function Hr(t,r,n){var e=t.left,i=t.right,o=e.size;if(o>r){var u=Hr(e,r,n);return u===e?t:t.copy(u,i)}r-=o;var a=t.array,s=a.length;if(s>r){var h=f(a,r,n);return h===a?t:new Fr(e,i,h)}var u=Hr(i,r-s,n);return u===i?t:t.copy(e,u)}function Vr(t,r){var n=t.left,e=t.right,i=n.size;if(i>r){var o=Vr(n,r);return ar(t,o,e)}r-=i;var u=t.array,f=u.length;if(f>r)return u=a(u,r),0===u.length?sr(n,e):new Fr(n,e,u);var o=Vr(e,r-f);return ar(t,n,o)}function Wr(t,r,n,e){if(r!==jn){var i=r.left,o=i.size;o>n&&Wr(t,i,n,e);var u=r.array,f=u.length;n-=o,e-=o,f>n&&e>0&&Mr(t,qr(u,n,e)),e>f&&Wr(t,r.right,n-f,e-f)}}function Xr(t,r,n){this.root=t,this.tail=r,this.tail_size=n,this.hash=null}function Yr(t){return t instanceof Xr}function Zr(t){return null!=t?t instanceof Xr?t:new Xr(jn,jn,0).concat(t):new Xr(jn,jn,0)}function tn(t,r,n){this.left=t,this.right=r,this.len=n,this.hash=null}function rn(t){return t instanceof tn}function nn(t){return null!=t?t instanceof tn?t:new tn(jn,jn,0).concat(t):new tn(jn,jn,0)}function en(t,r){this.root=t,this.len=r,this.hash=null}function on(t){return t instanceof en}function un(t){return null!=t?t instanceof en?t:new en(jn,0).concat(t):new en(jn,0)}function fn(t){if("string"!=typeof t)throw Error("Expected key to be a string or Tag but got "+t)}function an(t,r){this.keys=t,this.values=r,this.hash=null}function sn(t){return t instanceof an}function hn(t){var r={},n=[];if(null!=t){if(sn(t))return t;I(A(t),function(t){rr(t,function(t,e){fn(t),r[t]=n.push(e)-1})})}return new an(r,n)}function cn(t,r){this._id=++Mn,this._value=t,this._onchange=r}function ln(t){return pn(t)?t.get():t}function pn(t){return t instanceof cn}function vn(t,r){if(arguments.length<1||arguments.length>2)throw Error("Expected 1 to 2 arguments but got "+arguments.length);return new cn(t,r)}function yn(t,r){return t===r||er(t)===er(r)}function gn(t){if(V(t))return Object.isFrozen(t)||_r(t)||Dr(t)||Yr(t)||B(t)||rn(t)||on(t)||sn(t);var r=typeof t;return"string"===r||"number"===r||"boolean"===r||"symbol"===r||null==t}function dn(t){if(Array.isArray(t)){for(var r=Zr(),n=0,e=t.length;e>n;++n)r=r.insert(dn(t[n]));return r}if(W(t)){var r=Or();for(var i in t)r=r.set(i,dn(t[i]));return r}return t}var wn="48de6fff-9d11-472d-a76f-ed77a59a5cbc",mn=0,bn="[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}",En=RegExp("^"+bn+"$"),xn=RegExp("^\\(Tag "+wn+" [0-9]+\\)$"),kn=RegExp("^\\(UUIDTag "+bn+"\\)$"),zn="undefined"!=typeof Symbol&&void 0!==Symbol.iterator?Symbol.iterator:null,Sn=i("e1c3818d-4c4f-4703-980a-00969e4ca900"),_n=i("6199065c-b518-4cb3-8b41-ab70a9769ec3"),An=i("1b75a273-16bd-4248-be8a-e4b5e8c4b523"),In=i("89d8297c-d95e-4ce9-bc9b-6b6f73fa6a37"),On=i("99e14916-bc99-4c48-81aa-299cf1ad6de3"),Tn={},jn={};jn.depth=0,jn.size=0;var Dn={},Un={},Cn={};Un.toString=Cn.toString=q,Un.inspect=Cn.inspect=q,null!==zn&&(Un[zn]=Cn[zn]=function(){return c(this)}),F.prototype=Object.create(Cn),F.prototype[Sn]=or("Tuple"),F.prototype[An]=K,Tn.Tuple=function(t){return H(L(t))},F.prototype[On]=function(t){return J("Tuple",t)},F.prototype[_n]=function(){return c(this.values)},F.prototype.size=function(){return this.values.length},F.prototype.get=function(t){var r=this.size();if($(t,r))return this.values[t];throw Error("Index "+t+" is not valid")},F.prototype.modify=function(t,r){var n=this.size();if($(t,n)){var e=this.values,i=f(e,t,r);return i===e?this:new F(i)}throw Error("Index "+t+" is not valid")};var Rn=0;zr.prototype.copy=function(t,r){return new zr(t,r,this.hash,this.key,this.value)},zr.prototype.modify=function(t){var r=t.hash,n=t.key,e=t.value;return this.hash===r&&this.key===n&&this.value===e?this:new zr(this.left,this.right,r,n,e)},Sr.prototype=Object.create(Cn),Sr.prototype[An]=Q,Sr.prototype.isEmpty=wr,Sr.prototype.has=mr,Sr.prototype.remove=br(Sr),Sr.prototype.merge=Er,Sr.prototype[_n]=function(){return v(lr(this.root),function(t){return G([t.key,t.value])})},Sr.prototype[Sn]=function(t){return null===t.hash&&(t.hash=_r(t)&&!Ar(t)?"(Dict"+ir(t,"  ")+")":"(SortedDict "+er(t.sort)+ir(t,"  ")+")"),t.hash},Tn.Dict=function(t){return Or(N(t))},Sr.prototype[On]=function(t){if(_r(t)&&!Ar(t))return R("Dict",t);throw Error("Cannot convert SortedDict to JSON")},Sr.prototype.removeAll=function(){return new Sr(jn,this.sort,this.hash_fn)},Sr.prototype.get=function(t,r){var n=vr(this.root,this.sort,this.hash_fn(t));if(n===jn){if(2===arguments.length)return r;throw Error("Key "+t+" not found")}return n.value},Sr.prototype.set=function(t,r){var n=this.root,e=this.sort,i=this.hash_fn,o=i(t),u=yr(n,e,o,new zr(jn,jn,o,t,r));return u===n?this:new Sr(u,e,i)},Sr.prototype.modify=function(t,r){var n=this.root,e=this.sort,i=this.hash_fn,o=gr(n,e,i(t),t,r);return o===n?this:new Sr(o,e,i)},Tr.prototype.copy=function(t,r){return new Tr(t,r,this.hash,this.key)},Tr.prototype.modify=function(t){var r=t.hash,n=t.key;return this.hash===r&&this.key===n?this:new Tr(this.left,this.right,r,n)},jr.prototype=Object.create(Cn),jr.prototype[An]=K,jr.prototype.isEmpty=wr,jr.prototype.has=mr,jr.prototype.remove=br(jr),Tn.Set=function(t){return Rr(L(t))},jr.prototype[_n]=function(){return v(lr(this.root),function(t){return t.key})},jr.prototype[On]=function(t){if(Dr(t)&&!Ur(t))return J("Set",t);throw Error("Cannot convert SortedSet to JSON")},jr.prototype[Sn]=function(t){if(null===t.hash){var r=T(t,function(t){return er(t)}),n="  ";t.hash=Dr(t)&&!Ur(t)?"(Set"+ur(r,n)+")":"(SortedSet "+er(t.sort)+ur(r,n)+")"}return t.hash},jr.prototype.removeAll=function(){return new jr(jn,this.sort,this.hash_fn)},jr.prototype.add=function(t){var r=this.root,n=this.sort,e=this.hash_fn,i=e(t),o=yr(r,n,i,new Tr(jn,jn,i,t));return o===r?this:new jr(o,n,e)},jr.prototype.union=function(t){return x(t,this,function(t,r){return t.add(r)})},jr.prototype.intersect=function(t){var r=this;if(r.isEmpty())return r;var n=r.removeAll();return x(t,n,function(t,n){return r.has(n)?t.add(n):t})},jr.prototype.disjoint=function(t){var r=this;return x(t,r,function(t,n){return r.has(n)?t.remove(n):t.add(n)})},jr.prototype.subtract=function(t){return this.isEmpty()?this:x(t,this,function(t,r){return t.remove(r)})};var Jn=125,Nn=Math.ceil,Ln=Math.floor;Fr.prototype.copy=function(t,r){return new Fr(t,r,this.array)},Xr.prototype=Object.create(Cn),Xr.prototype[Sn]=or("List"),Xr.prototype[An]=K,Xr.prototype.has=P,Tn.List=function(t){return Zr(L(t))},Xr.prototype[On]=function(t){return J("List",t)},Xr.prototype[_n]=function(){var t=_(lr(this.root),function(t){return c(t.array)});return y(t,E(Nr(this.tail)))},Xr.prototype.isEmpty=function(){return this.root===jn&&this.tail===jn},Xr.prototype.removeAll=function(){return new Xr(jn,jn,0)},Xr.prototype.size=function(){return this.root.size+this.tail_size},Xr.prototype.get=function(t,r){var n=this.size();if(0>t&&(t+=n),$(t,n)){var e=this.root,i=e.size;return i>t?Br(e,t):Pr(this.tail,this.tail_size,t-i)}if(2===arguments.length)return r;throw Error("Index "+t+" is not valid")},Xr.prototype.insert=function(t,r){1===arguments.length&&(r=-1);var n=this.size();0>r&&(r+=n+1);var e=this.root,i=this.tail,o=this.tail_size;if(r===n){if(o===Jn){var f=cr(e,new Fr(jn,jn,$r(i,o)));return new Xr(f,new Jr(t,jn),1)}return new Xr(e,new Jr(t,i),o+1)}if($(r,n)){var a=e.size;if(a>r)return new Xr(Gr(e,r,t),i,o);var s=u($r(i,o),r-a,t),f=cr(e,new Fr(jn,jn,s));return new Xr(f,jn,0)}throw Error("Index "+r+" is not valid")},Xr.prototype.remove=function(t){0===arguments.length&&(t=-1);var r=this.size();0>t&&(t+=r);var n=this.root,e=this.tail,i=this.tail_size;if(e!==jn&&t===r-1)return new Xr(n,e.cdr,i-1);if($(t,r)){var o=n.size;if(o>t)return new Xr(Vr(n,t),e,i);var u=a($r(e,i),t-o),f=cr(n,new Fr(jn,jn,u));return new Xr(f,jn,0)}throw Error("Index "+t+" is not valid")},Xr.prototype.modify=function(t,r){var n=this.size();if(0>t&&(t+=n),$(t,n)){var e=this.root,i=this.tail,o=this.tail_size,u=e.size;if(i!==jn&&t===n-1){var a=r(i.car);return a===i.car?this:new Xr(e,new Jr(a,i.cdr),o)}if(u>t){var s=Hr(e,t,r);return s===e?this:new Xr(s,i,o)}var h=$r(i,o),c=f(h,t-u,r);if(c===h)return this;var s=cr(e,new Fr(jn,jn,c));return new Xr(s,jn,0)}throw Error("Index "+t+" is not valid")},Xr.prototype.slice=function(t,r){var n=this.size();if(null==t&&(t=0),null==r&&(r=n),0>t&&(t+=n),0>r&&(r+=n),0===t&&r===n)return this;if(t>r)throw Error("Index "+t+" is greater than index "+r);if($(t,n)){if(t===r)return new Xr(jn,jn,0);if(r>0&&n>=r){var e=this.root,i=e.size,o=[];if(i>=t&&Wr(o,e,t,r),r>i){var u=$r(this.tail,this.tail_size);Mr(o,qr(u,t-i,r-i))}return new Xr(Kr(o),jn,0)}throw Error("Index "+r+" is not valid")}throw Error("Index "+t+" is not valid")},Xr.prototype.concat=function(t){if(t instanceof Xr){var r=this.root,n=this.tail,e=t.root,i=t.tail;if(e===jn&&i===jn)return this;if(r===jn&&n===jn)return t;n!==jn&&(r=cr(r,new Fr(jn,jn,$r(n,this.tail_size))));var o=sr(r,e);return new Xr(o,i,t.tail_size)}return x(t,this,function(t,r){return t.insert(r)})},tn.prototype=Object.create(Cn),tn.prototype[An]=K,tn.prototype[Sn]=or("Queue"),tn.prototype.size=xr,tn.prototype.concat=kr,Tn.Queue=function(t){return nn(L(t))},tn.prototype[On]=function(t){return J("Queue",t)},tn.prototype.isEmpty=function(){return this.left===jn&&this.right===jn},tn.prototype.removeAll=function(){return new tn(jn,jn,0)},tn.prototype[_n]=function(){return y(Nr(this.left),E(Nr(this.right)))},tn.prototype.peek=function(t){if(this.isEmpty()){if(1===arguments.length)return t;throw Error("Cannot peek from an empty queue")}return this.left.car},tn.prototype.push=function(t){return this.isEmpty()?new tn(new Jr(t,this.left),this.right,this.len+1):new tn(this.left,new Jr(t,this.right),this.len+1)},tn.prototype.pop=function(){if(this.isEmpty())throw Error("Cannot pop from an empty queue");var t=this.left.cdr;if(t===jn){var r=jn;return Lr(this.right,function(t){r=new Jr(t,r)}),new tn(r,jn,this.len-1)}return new tn(t,this.right,this.len-1)},en.prototype=Object.create(Cn),en.prototype[An]=K,en.prototype[Sn]=or("Stack"),en.prototype.isEmpty=wr,en.prototype.size=xr,en.prototype.concat=kr,Tn.Stack=function(t){return un(L(t))},en.prototype[_n]=function(){return E(Nr(this.root))},en.prototype[On]=function(t){return J("Stack",t)},en.prototype.removeAll=function(){return new en(jn,0)},en.prototype.peek=function(t){if(this.isEmpty()){if(1===arguments.length)return t;throw Error("Cannot peek from an empty stack")}return this.root.car},en.prototype.push=function(t){return new en(new Jr(t,this.root),this.len+1)},en.prototype.pop=function(){if(this.isEmpty())throw Error("Cannot pop from an empty stack");return new en(this.root.cdr,this.len-1)},an.prototype=Object.create(Cn),an.prototype.update=Er,an.prototype[An]=Q,Tn.Record=function(t){return hn(N(t))},an.prototype[On]=function(t){return R("Record",t)},an.prototype[Sn]=function(t){return null===t.hash&&(t.hash="(Record"+ir(t,"  ")+")"),t.hash},an.prototype[_n]=function(){var t=this.keys,r=this.values;return c(T(A(t),function(t){return rr(t,function(t,n){return G([t,r[n]])})}))},an.prototype.get=function(t){fn(t);var r=this.keys[t];if(null==r)throw Error("Key "+t+" not found");return this.values[r]},an.prototype.set=function(t,r){return this.modify(t,function(){return r})},an.prototype.modify=function(t,r){fn(t);var n=this.keys,e=n[t];if(null==e)throw Error("Key "+t+" not found");var i=this.values,o=f(i,e,r);return o===i?this:new an(n,o)};var Mn=0;cn.prototype=Object.create(Un),cn.prototype[Sn]=function(t){return"(Ref "+er(t._id)+")"},cn.prototype.get=function(){return this._value},cn.prototype.set=function(t){var r=this._value;t!==r&&(this._value=t,null!=this._onchange&&this._onchange(r,t))},cn.prototype.modify=function(t){this.set(t(this.get()))},function(t,r){"function"==typeof define&&define.amd?define(["exports"],r):"object"==typeof exports?r(exports):(t.Immutable={},r(t.Immutable))}(this,function(t){t.equal=yn,t.fromJS=dn,t.toJS=M,t.isDict=_r,t.isSet=Dr,t.isSortedDict=Ar,t.isSortedSet=Ur,t.isList=Yr,t.isQueue=rn,t.isTuple=B,t.isStack=on,t.isImmutable=gn,t.SortedDict=Ir,t.SortedSet=Cr,t.isIterable=h,t.Dict=Or,t.Set=Rr,t.List=Zr,t.Tuple=H,t.Queue=nn,t.Stack=un,t.simpleSort=pr,t.isRecord=sn,t.Record=hn,t.toJSON=C,t.fromJSON=U,t.deref=ln,t.Ref=vn,t.isRef=pn,t.isTag=r,t.isUUIDTag=n,t.Tag=e,t.UUIDTag=i,t.each=I,t.map=T,t.keep=D,t.findIndex=O,t.reverse=j,t.foldl=x,t.foldr=k,t.join=S,t.zip=b,t.toArray=z,t.any=g,t.all=d,t.find=w,t.partition=m})}).call(this);