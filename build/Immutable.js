(function(){"use strict";function t(t){return"string"==typeof t&&gn.test(t)}function r(t){var r=typeof t;return"symbol"===r||"string"===r&&(dn.test(t)||wn.test(t))}function n(t){return"string"==typeof t&&wn.test(t)}function e(){if(0===arguments.length)return"(Tag "+ln+" "+ ++vn+")";throw Error("Expected 0 arguments but got "+arguments.length)}function o(r){if(1===arguments.length){if(t(r))return"(UUIDTag "+r+")";throw Error("Expected a lower-case UUID, but got: "+r)}throw Error("Expected 1 argument but got "+arguments.length)}function i(t){for(var r=t.length,n=Array(r),e=0;r>e;++e)n[e]=t[e];return n}function u(t,r,n){for(var e=t.length+1,o=Array(e),i=0;r>i;)o[i]=t[i],++i;for(o[i]=n,++i;e>i;)o[i]=t[i-1],++i;return o}function f(t,r,n){var e=t[r],o=n(e);if(e===o)return t;var u=i(t);return u[r]=o,u}function s(t,r){for(var n=t.length-1,e=Array(n),o=0;r>o;)e[o]=t[o],++o;for(;n>o;)e[o]=t[o+1],++o;return e}function a(t){var r=0;return{next:function(){return r<t.length?{value:t[r++]}:{done:!0}}}}function h(t){var r;if(null!=(r=t[En]))return r.call(t);if(null!==mn&&null!=(r=t[mn]))return r.call(t);if(Array.isArray(t))return a(t);if("string"==typeof t)return a(t);throw Error("Cannot iter: "+t)}function c(t){var r={};return r[En]=t,null!==mn&&(r[mn]=t),r}function p(t,r){for(;;){var n=t.next();if(n.done)break;r(n.value)}}function l(t,r){return{next:function(){var n=t.next();return n.done?{done:!0}:{value:r(n.value)}}}}function v(t,r){var n=!1,e=!1;return{next:function(){for(;;)if(n){if(e)return{done:!0};var o=r.next();if(!o.done)return o;e=!0}else{var o=t.next();if(!o.done)return o;n=!0}}}}function y(t,r){var n=2===arguments.length;return c(function(){var e=m(t).map(function(t){return h(t)}),o=!1;return{next:function(){for(;;){if(o)return{done:!0};for(var t=[],i=!1,u=0,f=e.length;f>u;++u){var s=e[u].next();if(s.done){if(!n){i=!1;break}t.push(r)}else i=!0,t.push(s.value)}if(i)return{value:q(t)};o=!0}}}})}function g(t){var r=[];p(t,function(t){r.push(t)});var n=r.length;return{next:function(){return n?{value:r[--n]}:{done:!0}}}}function d(t,r,n){return k(t,function(t){r=n(r,t)}),r}function w(t,r,n){return d(_(t),r,function(t,r){return n(r,t)})}function m(t){if(Array.isArray(t))return t;var r=[];return k(t,function(t){r.push(t)}),r}function b(t,r){return null==r&&(r=""),"string"==typeof t&&""===r?t:m(t).join(r)}function E(t,r){var n=!1,e=null;return{next:function(){for(;;){if(n)return{done:!0};if(null===e){var o=t.next();o.done?n=!0:e=r(o.value)}else{var o=e.next();if(!o.done)return o;e=null}}}}}function x(t){return F(t)?S(Object.keys(t),function(r){return[r,t[r]]}):t}function k(t,r){p(h(t),r)}function z(t,r,n){for(var e=h(t),o=0;;){var i=e.next();if(i.done){if(3===arguments.length)return n;throw Error("findIndex did not find anything")}if(r(i.value))return o;++o}}function S(t,r){return c(function(){return l(h(t),r)})}function _(t){return c(function(){return g(h(t))})}function A(t,r){return c(function(){var n=h(t);return{next:function(){for(;;){var t=n.next();if(t.done)return{done:!0};if(r(t.value))return t}}}})}function I(t){if(P(t)){var e=t[kn];if(null!=e){var o=Sn[e];if(null!=o)return o(t);throw Error("Cannot handle type "+e)}return t}if(r(t)){if(n(t))return t;throw Error("Cannot convert Tag from JSON, use UUIDTag instead: "+t)}return t}function O(t){if(P(t)){var e=t[zn];return null!=e?e(t):t}if(r(t)){if(n(t))return t;throw Error("Cannot convert Tag to JSON, use UUIDTag instead: "+t)}return t}function T(t,r){var n={};return n[kn]=t,n.keys=[],n.values=[],k(r,function(t){W(t,function(t,r){n.keys.push(O(t)),n.values.push(O(r))})}),n}function j(t,r){var n={};return n[kn]=t,n.values=[],k(r,function(t){n.values.push(O(t))}),n}function D(t){for(var r=t.keys,n=t.values,e=r.length,o=Array(e),i=0;e>i;++i)o[i]=[I(r[i]),I(n[i])];return o}function U(t){for(var r=t.values,n=r.length,e=Array(n),o=0;n>o;++o)e[o]=I(r[o]);return e}function C(t){if(P(t)){var r=t[xn];return null!=r?r(t):t}return t}function R(t){var r={};return k(t,function(t){W(t,function(t,n){if("string"!=typeof t)throw Error("Cannot convert to JavaScript: expected key to be string or Tag but got "+t);r[t]=C(n)})}),r}function J(t){var r=[];return k(t,function(t){r.push(C(t))}),r}function N(){return Y(this)}function L(t,r){return t>=0&&r>t}function M(t){var r=this.size();return 0>t&&(t+=r),L(t,r)}function Q(t){this.values=t,this.hash=null}function K(t){return t instanceof Q}function q(t){return new Q(t)}function $(t){if(null!=t){if(K(t))return t;var r=[];return k(t,function(t){r.push(t)}),new Q(r)}return new Q([])}function P(t){return Object(t)===t}function F(t){if(P(t)){var r=Object.getPrototypeOf(t);return null===r||r===Object.prototype}return!1}function B(t,r){return Array(r+1).join(t)}function G(t,r,n){var e=Math.max(0,r-t.length);return t+B(n,e)}function H(t){return t}function V(t,r){return 1===t?r:r+"s"}function W(t,r){if(Array.isArray(t)){if(2===t.length)return r(t[0],t[1]);throw Error("Expected array with 2 elements but got "+t.length+" "+V(t.length,"element"))}if(K(t)){if(2===t.size())return r(t.get(0),t.get(1));throw Error("Expected Tuple with 2 elements but got "+t.size()+" "+V(t.size(),"element"))}throw Error("Expected array or Tuple but got: "+t)}function X(t){return'"'+t.replace(/[\\\"\n]/g,function(t){return"\n"===t?t+" ":"\\"+t})+'"'}function Y(t){var n=typeof t;if("string"===n)return r(t)?t:X(t);if("number"===n||"boolean"===n||"undefined"===n||null===t)return""+t;var e=t[bn];if(null!=e)return e(t);var o="(Mutable "+ ++On+")";return Object.defineProperty(t,bn,{configurable:!1,enumerable:!1,writable:!1,value:function(){return o}}),o}function Z(t,r){var n=0,e=[];k(t,function(t){W(t,function(t,r){t=Y(t),r=Y(r),t=t.split(/\n/),k(t,function(t){n=Math.max(n,t.length)}),e.push({key:t,value:r})})});var r="  ";return e=S(e,function(t){var r=t.key.length-1;t.key[r]=G(t.key[r],n," ");var e=b(t.key,"\n"),o=t.value.replace(/\n/g,"\n"+B(" ",n+3));return e+" = "+o}),rr(e,r)}function tr(t){return function(r){if(null===r.hash){var n=S(r,function(t){return Y(t)});r.hash="("+t+rr(n,"  ")+")"}return r.hash}}function rr(t,r){var n="\n"+r;return b(S(t,function(t){return n+t.replace(/\n/g,n)}))}function nr(t,r){return t>r?t:r}function er(t,r,n){var e=r.depth,o=n.depth;if(e>o+1){var i=r.left,u=r.right;return u.depth>i.depth?u.copy(r.copy(i,u.left),t.copy(u.right,n)):r.copy(i,t.copy(u,n))}if(o>e+1){var f=n.right,s=n.left;return s.depth>f.depth?s.copy(t.copy(r,s.left),n.copy(s.right,f)):n.copy(t.copy(r,s),f)}return t.copy(r,n)}function or(t,r){if(t===_n)return r;if(r===_n)return t;if(t.depth<r.depth){var n=or(t,r.left);return er(r,n,r.right)}var e=or(t.right,r);return er(t,t.left,e)}function ir(t,r){return t===_n?r:er(t,ir(t.left,r),t.right)}function ur(t,r){return t===_n?r:er(t,t.left,ur(t.right,r))}function fr(t){for(var r=[];t!==_n;)r.push(t),t=t.left;return{next:function(){if(r.length){var n=r.pop();for(t=n.right;t!==_n;)r.push(t),t=t.left;return{value:n}}return{done:!0}}}}function sr(t,r){return t===r?0:r>t?-1:1}function ar(t,r,n){for(;t!==_n;){var e=r(n,t.hash);if(0===e)break;t=0>e?t.left:t.right}return t}function hr(t,r,n,e){if(t===_n)return e;var o=t.left,i=t.right,u=r(n,t.hash);if(0===u)return t.modify(e);if(0>u){var f=hr(o,r,n,e);return f===o?t:er(t,f,i)}var f=hr(i,r,n,e);return f===i?t:er(t,o,f)}function cr(t,r,n,e,o){if(t===_n)throw Error("Key "+e+" not found");var i=t.left,u=t.right,f=r(n,t.hash);if(0===f)return t.modify({key:e,hash:n,value:o(t.value)});if(0>f){var s=cr(i,r,n,e,o);return s===i?t:er(t,s,u)}var s=cr(u,r,n,e,o);return s===u?t:er(t,i,s)}function pr(t,r,n){if(t===_n)return t;var e=t.left,o=t.right,i=r(n,t.hash);if(0===i)return or(e,o);if(0>i){var u=pr(e,r,n);return u===e?t:er(t,u,o)}var u=pr(o,r,n);return u===o?t:er(t,e,u)}function lr(){return this.root===_n}function vr(t){return ar(this.root,this.sort,this.hash_fn(t))!==_n}function yr(t){return function(r){var n=this.root,e=this.sort,o=this.hash_fn,i=pr(n,e,o(r));return i===n?this:new t(i,e,o)}}function gr(t){return d(x(t),this,function(t,r){return W(r,function(r,n){return t.set(r,n)})})}function dr(){return this.len}function wr(t){return d(t,this,function(t,r){return t.push(r)})}function mr(t,r,n,e,o){this.left=t,this.right=r,this.hash=n,this.key=e,this.value=o,this.depth=nr(t.depth,r.depth)+1}function br(t,r,n){this.root=t,this.sort=r,this.hash_fn=n,this.hash=null}function Er(t){return t instanceof br}function xr(t){return Er(t)&&t.hash_fn===H}function kr(t,r){return null!=r?xr(r)&&r.sort===t?r:new br(_n,t,H).merge(r):new br(_n,t,H)}function zr(t){return null!=t?Er(t)&&!xr(t)?t:new br(_n,sr,Y).merge(t):new br(_n,sr,Y)}function Sr(t,r,n,e){this.left=t,this.right=r,this.hash=n,this.key=e,this.depth=nr(t.depth,r.depth)+1}function _r(t,r,n){this.root=t,this.sort=r,this.hash_fn=n,this.hash=null}function Ar(t){return t instanceof _r}function Ir(t){return Ar(t)&&t.hash_fn===H}function Or(t,r){return null!=r?Ir(r)&&r.sort===t?r:new _r(_n,t,H).union(r):new _r(_n,t,H)}function Tr(t){return null!=t?Ar(t)&&!Ir(t)?t:new _r(_n,sr,Y).union(t):new _r(_n,sr,Y)}function jr(t,r){this.car=t,this.cdr=r}function Dr(t){return{next:function(){if(t===_n)return{done:!0};var r=t.car;return t=t.cdr,{value:r}}}}function Ur(t,r){for(;t!==_n;)r(t.car),t=t.cdr}function Cr(t,r){if(t.length){var n=t[t.length-1];n.length+r.length<=Tn?t[t.length-1]=n.concat(r):t.push(r)}else t.push(r)}function Rr(t,r,n){if(n>r){var e=Dn((r+n)/2),o=Rr(t,r,e),i=Rr(t,e+1,n);return new Qr(o,i,t[e])}return _n}function Jr(t){return Rr(t,0,t.length)}function Nr(t,r,n){0>r&&(r=0);var e=t.length;return n>e&&(n=e),0===r&&n===e?t:t.slice(r,n)}function Lr(t,r){for(var n=Array(r);r--;)n[r]=t.car,t=t.cdr;return n}function Mr(t,r,n){for(;--r!==n;)t=t.cdr;return t.car}function Qr(t,r,n){this.left=t,this.right=r,this.array=n,this.size=t.size+r.size+n.length,this.depth=nr(t.depth,r.depth)+1}function Kr(t,r){for(;;){var n=t.left,e=n.size;if(e>r)t=n;else{r-=e;var o=t.array,i=o.length;if(i>r)return o[r];r-=i,t=t.right}}}function qr(t,r,n){if(t===_n)return new Qr(_n,_n,[n]);var e=t.left,o=t.right,i=e.size;if(i>r){var f=qr(e,r,n);return er(t,f,o)}r-=i;var s=t.array,a=s.length;if(a>=r){if(s=u(s,r,n),a===Tn){var h=jn(s.length/2),c=s.slice(0,h),p=s.slice(h);return e.depth<o.depth?new Qr(ur(e,new Qr(_n,_n,c)),o,p):new Qr(e,ir(o,new Qr(_n,_n,p)),c)}return new Qr(e,o,s)}var f=qr(o,r-a,n);return er(t,e,f)}function $r(t,r,n){var e=t.left,o=t.right,i=e.size;if(i>r){var u=$r(e,r,n);return u===e?t:t.copy(u,o)}r-=i;var s=t.array,a=s.length;if(a>r){var h=f(s,r,n);return h===s?t:new Qr(e,o,h)}var u=$r(o,r-a,n);return u===o?t:t.copy(e,u)}function Pr(t,r){var n=t.left,e=t.right,o=n.size;if(o>r){var i=Pr(n,r);return er(t,i,e)}r-=o;var u=t.array,f=u.length;if(f>r)return u=s(u,r),0===u.length?or(n,e):new Qr(n,e,u);var i=Pr(e,r-f);return er(t,n,i)}function Fr(t,r,n,e){if(r!==_n){var o=r.left,i=o.size;i>n&&Fr(t,o,n,e);var u=r.array,f=u.length;n-=i,e-=i,f>n&&e>0&&Cr(t,Nr(u,n,e)),e>f&&Fr(t,r.right,n-f,e-f)}}function Br(t,r,n){this.root=t,this.tail=r,this.tail_size=n,this.hash=null}function Gr(t){return t instanceof Br}function Hr(t){return null!=t?t instanceof Br?t:new Br(_n,_n,0).concat(t):new Br(_n,_n,0)}function Vr(t,r,n){this.left=t,this.right=r,this.len=n,this.hash=null}function Wr(t){return t instanceof Vr}function Xr(t){return null!=t?t instanceof Vr?t:new Vr(_n,_n,0).concat(t):new Vr(_n,_n,0)}function Yr(t,r){this.root=t,this.len=r,this.hash=null}function Zr(t){return t instanceof Yr}function tn(t){return null!=t?t instanceof Yr?t:new Yr(_n,0).concat(t):new Yr(_n,0)}function rn(t){if("string"!=typeof t)throw Error("Expected key to be a string or Tag but got "+t)}function nn(t,r){this.keys=t,this.values=r,this.hash=null}function en(t){return t instanceof nn}function on(t){var r={},n=[];if(null!=t){if(en(t))return t;k(x(t),function(t){W(t,function(t,e){rn(t),r[t]=n.push(e)-1})})}return new nn(r,n)}function un(t,r){this._id=++Un,this._value=t,this._onchange=r}function fn(t){return sn(t)?t.get():t}function sn(t){return t instanceof un}function an(t,r){if(arguments.length<1||arguments.length>2)throw Error("Expected 1 to 2 arguments but got "+arguments.length);return new un(t,r)}function hn(t,r){return t===r||Y(t)===Y(r)}function cn(t){if(P(t))return Object.isFrozen(t)||Er(t)||Ar(t)||Gr(t)||K(t)||Wr(t)||Zr(t)||en(t);var r=typeof t;return"string"===r||"number"===r||"boolean"===r||"symbol"===r||null==t}function pn(t){if(Array.isArray(t)){for(var r=Hr(),n=0,e=t.length;e>n;++n)r=r.insert(pn(t[n]));return r}if(F(t)){var r=zr();for(var o in t)r=r.set(o,pn(t[o]));return r}return t}var ln="48de6fff-9d11-472d-a76f-ed77a59a5cbc",vn=0,yn="[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}",gn=RegExp("^"+yn+"$"),dn=RegExp("^\\(Tag "+ln+" [0-9]+\\)$"),wn=RegExp("^\\(UUIDTag "+yn+"\\)$"),mn="undefined"!=typeof Symbol&&void 0!==Symbol.iterator?Symbol.iterator:null,bn=o("e1c3818d-4c4f-4703-980a-00969e4ca900"),En=o("6199065c-b518-4cb3-8b41-ab70a9769ec3"),xn=o("1b75a273-16bd-4248-be8a-e4b5e8c4b523"),kn=o("89d8297c-d95e-4ce9-bc9b-6b6f73fa6a37"),zn=o("99e14916-bc99-4c48-81aa-299cf1ad6de3"),Sn={},_n={};_n.depth=0,_n.size=0;var An={},In={};An.toString=In.toString=N,An.inspect=In.inspect=N,null!==mn&&(An[mn]=In[mn]=function(){return h(this)}),Q.prototype=Object.create(In),Q.prototype[bn]=tr("Tuple"),Q.prototype[xn]=J,Sn.Tuple=function(t){return $(U(t))},Q.prototype[zn]=function(t){return j("Tuple",t)},Q.prototype[En]=function(){return h(this.values)},Q.prototype.size=function(){return this.values.length},Q.prototype.get=function(t){var r=this.size();if(L(t,r))return this.values[t];throw Error("Index "+t+" is not valid")},Q.prototype.modify=function(t,r){var n=this.size();if(L(t,n)){var e=this.values,o=f(e,t,r);return o===e?this:new Q(o)}throw Error("Index "+t+" is not valid")};var On=0;mr.prototype.copy=function(t,r){return new mr(t,r,this.hash,this.key,this.value)},mr.prototype.modify=function(t){var r=t.hash,n=t.key,e=t.value;return this.hash===r&&this.key===n&&this.value===e?this:new mr(this.left,this.right,r,n,e)},br.prototype=Object.create(In),br.prototype[xn]=R,br.prototype.isEmpty=lr,br.prototype.has=vr,br.prototype.remove=yr(br),br.prototype.merge=gr,br.prototype[En]=function(){return l(fr(this.root),function(t){return q([t.key,t.value])})},br.prototype[bn]=function(t){return null===t.hash&&(t.hash=Er(t)&&!xr(t)?"(Dict"+Z(t,"  ")+")":"(SortedDict "+Y(t.sort)+Z(t,"  ")+")"),t.hash},Sn.Dict=function(t){return zr(D(t))},br.prototype[zn]=function(t){if(Er(t)&&!xr(t))return T("Dict",t);throw Error("Cannot convert SortedDict to JSON")},br.prototype.removeAll=function(){return new br(_n,this.sort,this.hash_fn)},br.prototype.get=function(t,r){var n=ar(this.root,this.sort,this.hash_fn(t));if(n===_n){if(2===arguments.length)return r;throw Error("Key "+t+" not found")}return n.value},br.prototype.set=function(t,r){var n=this.root,e=this.sort,o=this.hash_fn,i=o(t),u=hr(n,e,i,new mr(_n,_n,i,t,r));return u===n?this:new br(u,e,o)},br.prototype.modify=function(t,r){var n=this.root,e=this.sort,o=this.hash_fn,i=cr(n,e,o(t),t,r);return i===n?this:new br(i,e,o)},Sr.prototype.copy=function(t,r){return new Sr(t,r,this.hash,this.key)},Sr.prototype.modify=function(t){var r=t.hash,n=t.key;return this.hash===r&&this.key===n?this:new Sr(this.left,this.right,r,n)},_r.prototype=Object.create(In),_r.prototype[xn]=J,_r.prototype.isEmpty=lr,_r.prototype.has=vr,_r.prototype.remove=yr(_r),Sn.Set=function(t){return Tr(U(t))},_r.prototype[En]=function(){return l(fr(this.root),function(t){return t.key})},_r.prototype[zn]=function(t){if(Ar(t)&&!Ir(t))return j("Set",t);throw Error("Cannot convert SortedSet to JSON")},_r.prototype[bn]=function(t){if(null===t.hash){var r=S(t,function(t){return Y(t)}),n="  ";t.hash=Ar(t)&&!Ir(t)?"(Set"+rr(r,n)+")":"(SortedSet "+Y(t.sort)+rr(r,n)+")"}return t.hash},_r.prototype.removeAll=function(){return new _r(_n,this.sort,this.hash_fn)},_r.prototype.add=function(t){var r=this.root,n=this.sort,e=this.hash_fn,o=e(t),i=hr(r,n,o,new Sr(_n,_n,o,t));return i===r?this:new _r(i,n,e)},_r.prototype.union=function(t){return d(t,this,function(t,r){return t.add(r)})},_r.prototype.intersect=function(t){var r=this;if(r.isEmpty())return r;var n=r.removeAll();return d(t,n,function(t,n){return r.has(n)?t.add(n):t})},_r.prototype.disjoint=function(t){var r=this;return d(t,r,function(t,n){return r.has(n)?t.remove(n):t.add(n)})},_r.prototype.subtract=function(t){return this.isEmpty()?this:d(t,this,function(t,r){return t.remove(r)})};var Tn=125,jn=Math.ceil,Dn=Math.floor;Qr.prototype.copy=function(t,r){return new Qr(t,r,this.array)},Br.prototype=Object.create(In),Br.prototype[bn]=tr("List"),Br.prototype[xn]=J,Br.prototype.has=M,Sn.List=function(t){return Hr(U(t))},Br.prototype[zn]=function(t){return j("List",t)},Br.prototype[En]=function(){var t=E(fr(this.root),function(t){return h(t.array)});return v(t,g(Dr(this.tail)))},Br.prototype.isEmpty=function(){return this.root===_n&&this.tail===_n},Br.prototype.removeAll=function(){return new Br(_n,_n,0)},Br.prototype.size=function(){return this.root.size+this.tail_size},Br.prototype.get=function(t,r){var n=this.size();if(0>t&&(t+=n),L(t,n)){var e=this.root,o=e.size;return o>t?Kr(e,t):Mr(this.tail,this.tail_size,t-o)}if(2===arguments.length)return r;throw Error("Index "+t+" is not valid")},Br.prototype.insert=function(t,r){1===arguments.length&&(r=-1);var n=this.size();0>r&&(r+=n+1);var e=this.root,o=this.tail,i=this.tail_size;if(r===n){if(i===Tn){var f=ur(e,new Qr(_n,_n,Lr(o,i)));return new Br(f,new jr(t,_n),1)}return new Br(e,new jr(t,o),i+1)}if(L(r,n)){var s=e.size;if(s>r)return new Br(qr(e,r,t),o,i);var a=u(Lr(o,i),r-s,t),f=ur(e,new Qr(_n,_n,a));return new Br(f,_n,0)}throw Error("Index "+r+" is not valid")},Br.prototype.remove=function(t){0===arguments.length&&(t=-1);var r=this.size();0>t&&(t+=r);var n=this.root,e=this.tail,o=this.tail_size;if(e!==_n&&t===r-1)return new Br(n,e.cdr,o-1);if(L(t,r)){var i=n.size;if(i>t)return new Br(Pr(n,t),e,o);var u=s(Lr(e,o),t-i),f=ur(n,new Qr(_n,_n,u));return new Br(f,_n,0)}throw Error("Index "+t+" is not valid")},Br.prototype.modify=function(t,r){var n=this.size();if(0>t&&(t+=n),L(t,n)){var e=this.root,o=this.tail,i=this.tail_size,u=e.size;if(o!==_n&&t===n-1){var s=r(o.car);return s===o.car?this:new Br(e,new jr(s,o.cdr),i)}if(u>t){var a=$r(e,t,r);return a===e?this:new Br(a,o,i)}var h=Lr(o,i),c=f(h,t-u,r);if(c===h)return this;var a=ur(e,new Qr(_n,_n,c));return new Br(a,_n,0)}throw Error("Index "+t+" is not valid")},Br.prototype.slice=function(t,r){var n=this.size();if(null==t&&(t=0),null==r&&(r=n),0>t&&(t+=n),0>r&&(r+=n),0===t&&r===n)return this;if(t>r)throw Error("Index "+t+" is greater than index "+r);if(L(t,n)){if(t===r)return new Br(_n,_n,0);if(r>0&&n>=r){var e=this.root,o=e.size,i=[];if(o>=t&&Fr(i,e,t,r),r>o){var u=Lr(this.tail,this.tail_size);Cr(i,Nr(u,t-o,r-o))}return new Br(Jr(i),_n,0)}throw Error("Index "+r+" is not valid")}throw Error("Index "+t+" is not valid")},Br.prototype.concat=function(t){if(t instanceof Br){var r=this.root,n=this.tail,e=t.root,o=t.tail;if(e===_n&&o===_n)return this;if(r===_n&&n===_n)return t;n!==_n&&(r=ur(r,new Qr(_n,_n,Lr(n,this.tail_size))));var i=or(r,e);return new Br(i,o,t.tail_size)}return d(t,this,function(t,r){return t.insert(r)})},Vr.prototype=Object.create(In),Vr.prototype[xn]=J,Vr.prototype[bn]=tr("Queue"),Vr.prototype.size=dr,Vr.prototype.concat=wr,Sn.Queue=function(t){return Xr(U(t))},Vr.prototype[zn]=function(t){return j("Queue",t)},Vr.prototype.isEmpty=function(){return this.left===_n&&this.right===_n},Vr.prototype.removeAll=function(){return new Vr(_n,_n,0)},Vr.prototype[En]=function(){return v(Dr(this.left),g(Dr(this.right)))},Vr.prototype.peek=function(t){if(this.isEmpty()){if(1===arguments.length)return t;throw Error("Cannot peek from an empty queue")}return this.left.car},Vr.prototype.push=function(t){return this.isEmpty()?new Vr(new jr(t,this.left),this.right,this.len+1):new Vr(this.left,new jr(t,this.right),this.len+1)},Vr.prototype.pop=function(){if(this.isEmpty())throw Error("Cannot pop from an empty queue");var t=this.left.cdr;if(t===_n){var r=_n;return Ur(this.right,function(t){r=new jr(t,r)}),new Vr(r,_n,this.len-1)}return new Vr(t,this.right,this.len-1)},Yr.prototype=Object.create(In),Yr.prototype[xn]=J,Yr.prototype[bn]=tr("Stack"),Yr.prototype.isEmpty=lr,Yr.prototype.size=dr,Yr.prototype.concat=wr,Sn.Stack=function(t){return tn(U(t))},Yr.prototype[En]=function(){return g(Dr(this.root))},Yr.prototype[zn]=function(t){return j("Stack",t)},Yr.prototype.removeAll=function(){return new Yr(_n,0)},Yr.prototype.peek=function(t){if(this.isEmpty()){if(1===arguments.length)return t;throw Error("Cannot peek from an empty stack")}return this.root.car},Yr.prototype.push=function(t){return new Yr(new jr(t,this.root),this.len+1)},Yr.prototype.pop=function(){if(this.isEmpty())throw Error("Cannot pop from an empty stack");return new Yr(this.root.cdr,this.len-1)},nn.prototype=Object.create(In),nn.prototype.update=gr,nn.prototype[xn]=R,Sn.Record=function(t){return on(D(t))},nn.prototype[zn]=function(t){return T("Record",t)},nn.prototype[bn]=function(t){return null===t.hash&&(t.hash="(Record"+Z(t,"  ")+")"),t.hash},nn.prototype[En]=function(){var t=this.keys,r=this.values;return h(S(x(t),function(t){return W(t,function(t,n){return q([t,r[n]])})}))},nn.prototype.get=function(t){rn(t);var r=this.keys[t];if(null==r)throw Error("Key "+t+" not found");return this.values[r]},nn.prototype.set=function(t,r){return this.modify(t,function(){return r})},nn.prototype.modify=function(t,r){rn(t);var n=this.keys,e=n[t];if(null==e)throw Error("Key "+t+" not found");var o=this.values,i=f(o,e,r);return i===o?this:new nn(n,i)};var Un=0;un.prototype=Object.create(An),un.prototype[bn]=function(t){return"(Ref "+Y(t._id)+")"},un.prototype.get=function(){return this._value},un.prototype.set=function(t){var r=this._value;t!==r&&(this._value=t,null!=this._onchange&&this._onchange(r,t))},un.prototype.modify=function(t){this.set(t(this.get()))},function(t,r){"function"==typeof define&&define.amd?define(["exports"],r):"object"==typeof exports?r(exports):(t.Immutable={},r(t.Immutable))}(this,function(t){t.equal=hn,t.fromJS=pn,t.toJS=C,t.isDict=Er,t.isSet=Ar,t.isSortedDict=xr,t.isSortedSet=Ir,t.isList=Gr,t.isQueue=Wr,t.isTuple=K,t.isStack=Zr,t.isImmutable=cn,t.SortedDict=kr,t.SortedSet=Or,t.Dict=zr,t.Set=Tr,t.List=Hr,t.Tuple=$,t.Queue=Xr,t.Stack=tn,t.simpleSort=sr,t.isRecord=en,t.Record=on,t.toJSON=O,t.fromJSON=I,t.deref=fn,t.Ref=an,t.isRef=sn,t.isTag=r,t.isUUIDTag=n,t.Tag=e,t.UUIDTag=o,t.each=k,t.map=S,t.keep=A,t.findIndex=z,t.reverse=_,t.foldl=d,t.foldr=w,t.join=b,t.zip=y,t.toArray=m})}).call(this);