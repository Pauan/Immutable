/**
 * @license
 *
 * (c) 2014, 2015 Oni Labs, http://onilabs.com
 *
 * This file is licensed under the terms of the MIT License:
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */
(function(){"use strict";function t(t){for(var r=t.length,n=Array(r),e=0;r>e;++e)n[e]=t[e];return n}function r(t,r,n){for(var e=t.length+1,o=Array(e),i=0;r>i;)o[i]=t[i],++i;for(o[i]=n,++i;e>i;)o[i]=t[i-1],++i;return o}function n(r,n,e){var o=r[n],i=e(o);if(o===i)return r;var u=t(r);return u[n]=i,u}function e(t,r){for(var n=t.length-1,e=Array(n),o=0;r>o;)e[o]=t[o],++o;for(;n>o;)e[o]=t[o+1],++o;return e}function o(t){return"string"==typeof t&&jn.test(t)}function i(t){return"string"==typeof t&&(In.test(t)||Tn.test(t))}function u(t){return"string"==typeof t&&Tn.test(t)}function f(){if(0===arguments.length)return"(Tag "+On+" "+ ++_n+")";throw Error("Expected 0 arguments but got "+arguments.length)}function a(t){if(1===arguments.length){if(o(t))return"(UUIDTag "+t+")";throw Error("Expected a lower-case UUID, but got: "+t)}throw Error("Expected 1 argument but got "+arguments.length)}function s(t,r){return t===r||L(t)===L(r)}function h(t){var r=0;return{next:function(){return r<t.length?{value:t[r++]}:{done:!0}}}}function c(t){return Xr(t)?null!=t[Un]||null!==Cn&&null!=t[Cn]||Array.isArray(t):"string"==typeof t&&!i(t)}function l(t){var r;if(null!=(r=t[Un]))return r.call(t);if(null!==Cn&&null!=(r=t[Cn]))return r.call(t);if(Array.isArray(t))return h(t);if("string"!=typeof t||i(t))throw Error("Cannot iter: "+t);return h(t)}function p(t){function r(){return t()}var n={};return n[Un]=r,null!==Cn&&(n[Cn]=r),n}function v(t,r){for(;;){var n=t.next();if(n.done)break;r(n.value)}}function y(t,r){return{next:function(){var n=t.next();return n.done?{done:!0}:{value:r(n.value)}}}}function g(t,r){var n=!1,e=!1;return{next:function(){for(;;)if(n){if(e)return{done:!0};var o=r.next();if(!o.done)return{value:o.value};e=!0}else{var o=t.next();if(!o.done)return{value:o.value};n=!0}}}}function d(t,r){for(var n=l(t);;){var e=n.next();if(e.done)return!1;if(r(e.value))return!0}}function w(t,r){for(var n=l(t);;){var e=n.next();if(e.done)return!0;if(!r(e.value))return!1}}function m(t,r,n){for(var e=l(t);;){var o=e.next();if(o.done){if(3===arguments.length)return n;throw Error("Did not find anything")}if(r(o.value))return o.value}}function b(t,r){var n=[],e=[],o=Kn,i=!1;return Gr([p(function(){return o===Kn&&(o=l(t)),{next:function(){for(;;){if(n.length)return n.shift();if(i)return{done:!0};var t=o.next();if(t.done)i=!0;else{if(r(t.value))return{value:t.value};e.push({value:t.value})}}}}}),p(function(){return o===Kn&&(o=l(t)),{next:function(){for(;;){if(e.length)return e.shift();if(i)return{done:!0};var t=o.next();if(t.done)i=!0;else{if(!r(t.value))return{value:t.value};n.push({value:t.value})}}}}})])}function E(t,r){var n=2===arguments.length;return p(function(){var e=z(t).map(function(t){return l(t)}),o=!1;return{next:function(){for(;;){if(o)return{done:!0};for(var t=[],i=!1,u=0,f=e.length;f>u;++u){var a=e[u].next();if(a.done){if(!n){i=!1;break}t.push(r)}else i=!0,t.push(a.value)}if(i)return{value:Gr(t)};o=!0}}}})}function x(t){var r=[];v(t,function(t){r.push(t)});var n=r.length;return{next:function(){return n?{value:r[--n]}:{done:!0}}}}function S(t,r,n){return j(t,function(t){r=n(r,t)}),r}function k(t,r,n){return S(U(t),r,function(t,r){return n(r,t)})}function z(t){if(Array.isArray(t))return t;var r=[];return j(t,function(t){r.push(t)}),r}function O(t,r){return 1===arguments.length&&(r=""),"string"==typeof t&&""===r?t:z(t).join(r)}function _(t,r){var n=!1,e=Kn;return{next:function(){for(;;){if(n)return{done:!0};if(e===Kn){var o=t.next();o.done?n=!0:e=r(o.value)}else{var o=e.next();if(!o.done)return{value:o.value};e=Kn}}}}}function A(t){return Yr(t)?J(Object.keys(t),function(r){return[r,t[r]]}):t}function j(t,r){v(l(t),r)}function I(t,r,n){for(var e=l(t),o=0;;){var i=e.next();if(i.done){if(3===arguments.length)return n;throw Error("Did not find anything")}if(r(i.value))return o;++o}}function T(t,r,n){return 3===arguments.length?I(t,function(t){return s(t,r)},n):I(t,function(t){return s(t,r)})}function C(t,r){if(Math.round(r)!==r)throw Error("Count must be an integer");if(0>r)throw Error("Count cannot be negative");return p(function(){var n=l(t);return{next:function(){for(;;){if(0>r)throw Error("Invalid count");if(0===r)return{done:!0};var t=n.next();if(!t.done)return--r,{value:t.value};r=0}}}})}function D(t,r,n){if(arguments.length<1&&(t=0),arguments.length<2&&(r=1/0),arguments.length<3&&(n=1),0>n)throw Error("Step cannot be negative");return p(function(){if(r>t)var e=function(){if(r>t){var e=t;return t+=n,{value:e}}return{done:!0}};else var e=function(){if(t>r){var e=t;return t-=n,{value:e}}return{done:!0}};return{next:e}})}function J(t,r){return p(function(){return y(l(t),r)})}function U(t){return p(function(){return x(l(t))})}function N(t,r){return p(function(){var n=l(t);return{next:function(){for(;;){var t=n.next();if(t.done)return{done:!0};if(r(t.value))return{value:t.value}}}}})}function R(t){return'"'+t.replace(/[\\\"\n]/g,function(t){return"\n"===t?t+" ":"\\"+t})+'"'}function M(t){var r;return null!==Dn&&null!=(r=Dn(t))?"(Symbol.for "+L(r)+")":(r=$n[t],null==r&&(r=$n[t]=++Fn),"(Symbol "+r+")")}function L(t){var r=typeof t;if("string"===r)return i(t)?t:R(t);if("number"===r||"boolean"===r||"undefined"===r||null===t)return""+t;if("symbol"===r)return M(t);var n=t[Jn];if(null!=n)return n(t);if(Object.isExtensible(t)){var e="(Mutable "+ ++qn+")";return Object.defineProperty(t,Jn,{configurable:!1,enumerable:!1,writable:!1,value:function(){return e}}),e}throw Error("Cannot use a non-extensible object as a key: "+t)}function Q(t,r){var n=0,e=[];j(t,function(t){en(t,function(t,r){t=L(t),r=L(r),t=t.split(/\n/),j(t,function(t){n=Math.max(n,t.length)}),e.push({key:t,value:r})})});var r="  ";return e=J(e,function(t){var r=t.key.length-1;t.key[r]=tn(t.key[r],n," ");var e=O(t.key,"\n"),o=t.value.replace(/\n/g,"\n"+Zr(" ",n+3));return e+" = "+o}),q(e,r)}function K(t){return function(r){if(null===r.hash){var n=J(r,function(t){return L(t)});r.hash="("+t+q(n,"  ")+")"}return r.hash}}function q(t,r){var n="\n"+r;return O(J(t,function(t){return n+t.replace(/\n/g,n)}))}function F(t){var r=typeof t;if(i(t)){if(u(t))return t;throw Error("Cannot convert Tag from JSON, use UUIDTag instead: "+t)}if("string"===r||"boolean"===r||null===t||Wr(t))return t;if(Xr(t)){var r=t[Rn];if(null!=r){var n=Ln[r];if(null!=n)return n(t);throw Error("Cannot handle type "+r)}if(Array.isArray(t))return t.map(F);if(Yr(t)){var e={};return Object.keys(t).forEach(function(r){e[F(r)]=F(t[r])}),e}throw Error("Cannot convert from JSON: "+t)}throw Error("Cannot convert from JSON: "+t)}function $(t){var r=typeof t;if(i(t)){if(u(t))return t;throw Error("Cannot convert Tag to JSON, use UUIDTag instead: "+t)}if("string"===r||"boolean"===r||null===t||Wr(t))return t;if(Xr(t)){var n=t[Mn];if(null!=n)return n(t);if("function"==typeof t.toJSON)return $(t.toJSON());if(Array.isArray(t))return t.map($);if(Yr(t)){var e={};return Object.keys(t).forEach(function(r){e[$(r)]=$(t[r])}),e}throw Error("Cannot convert to JSON: "+t)}throw Error("Cannot convert to JSON: "+t)}function P(t,r){var n={};return n[Rn]=t,n.keys=[],n.values=[],j(r,function(t){en(t,function(t,r){n.keys.push($(t)),n.values.push($(r))})}),n}function B(t,r){var n={};return n[Rn]=t,n.values=[],j(r,function(t){n.values.push($(t))}),n}function G(t){for(var r=t.keys,n=t.values,e=r.length,o=Array(e),i=0;e>i;++i)o[i]=[F(r[i]),F(n[i])];return o}function H(t){for(var r=t.values,n=r.length,e=Array(n),o=0;n>o;++o)e[o]=F(r[o]);return e}function V(t,r){return t>r?t:r}function W(t,r,n){var e=r.depth,o=n.depth;if(e>o+1){var i=r.left,u=r.right;return u.depth>i.depth?u.copy(r.copy(i,u.left),t.copy(u.right,n)):r.copy(i,t.copy(u,n))}if(o>e+1){var f=n.right,a=n.left;return a.depth>f.depth?a.copy(t.copy(r,a.left),n.copy(a.right,f)):n.copy(t.copy(r,a),f)}return t.copy(r,n)}function X(t,r){if(t===Qn)return r;if(r===Qn)return t;if(t.depth<r.depth){var n=X(t,r.left);return W(r,n,r.right)}var e=X(t.right,r);return W(t,t.left,e)}function Y(t,r){return t===Qn?r:W(t,Y(t.left,r),t.right)}function Z(t,r){return t===Qn?r:W(t,t.left,Z(t.right,r))}function tr(t){for(var r=[];t!==Qn;)r.push(t),t=t.left;return{next:function(){if(r.length){var n=r.pop();for(t=n.right;t!==Qn;)r.push(t),t=t.left;return{value:n}}return{done:!0}}}}function rr(){return L(this)}function nr(){return $(this)}function er(t,r){return t>=0&&r>t}function or(t){var r=this.size();return 0>t&&(t+=r),er(t,r)}function ir(t,r){this.car=t,this.cdr=r}function ur(t){return{next:function(){if(t===Qn)return{done:!0};var r=t.car;return t=t.cdr,{value:r}}}}function fr(t,r){for(;t!==Qn;)r(t.car),t=t.cdr}function ar(t,r){if(t.length){var n=t[t.length-1];n.length+r.length<=Gn?t[t.length-1]=n.concat(r):t.push(r)}else t.push(r)}function sr(t,r,n){if(n>r){var e=Vn((r+n)/2),o=sr(t,r,e),i=sr(t,e+1,n);return new vr(o,i,t[e])}return Qn}function hr(t){return sr(t,0,t.length)}function cr(t,r,n){0>r&&(r=0);var e=t.length;return n>e&&(n=e),0===r&&n===e?t:t.slice(r,n)}function lr(t,r){for(var n=Array(r);r--;)n[r]=t.car,t=t.cdr;return n}function pr(t,r,n){for(;--r!==n;)t=t.cdr;return t.car}function vr(t,r,n){this.left=t,this.right=r,this.array=n,this.size=t.size+r.size+n.length,this.depth=V(t.depth,r.depth)+1}function yr(t,r){for(;;){var n=t.left,e=n.size;if(e>r)t=n;else{r-=e;var o=t.array,i=o.length;if(i>r)return o[r];r-=i,t=t.right}}}function gr(t,n,e){if(t===Qn)return new vr(Qn,Qn,[e]);var o=t.left,i=t.right,u=o.size;if(u>n){var f=gr(o,n,e);return W(t,f,i)}n-=u;var a=t.array,s=a.length;if(s>=n){if(a=r(a,n,e),s===Gn){var h=Hn(a.length/2),c=a.slice(0,h),l=a.slice(h);return o.depth<i.depth?new vr(Z(o,new vr(Qn,Qn,c)),i,l):new vr(o,Y(i,new vr(Qn,Qn,l)),c)}return new vr(o,i,a)}var f=gr(i,n-s,e);return W(t,o,f)}function dr(t,r,e){var o=t.left,i=t.right,u=o.size;if(u>r){var f=dr(o,r,e);return f===o?t:t.copy(f,i)}r-=u;var a=t.array,s=a.length;if(s>r){var h=n(a,r,e);return h===a?t:new vr(o,i,h)}var f=dr(i,r-s,e);return f===i?t:t.copy(o,f)}function wr(t,r){var n=t.left,o=t.right,i=n.size;if(i>r){var u=wr(n,r);return W(t,u,o)}r-=i;var f=t.array,a=f.length;if(a>r)return f=e(f,r),0===f.length?X(n,o):new vr(n,o,f);var u=wr(o,r-a);return W(t,n,u)}function mr(t,r,n,e){if(r!==Qn){var o=r.left,i=o.size;i>n&&mr(t,o,n,e);var u=r.array,f=u.length;n-=i,e-=i,f>n&&e>0&&ar(t,cr(u,n,e)),e>f&&mr(t,r.right,n-f,e-f)}}function br(t,r){if(t===Qn)return new vr(Qn,Qn,r);var n=t.left,e=t.right,o=t.array;return e===Qn&&o.length+r.length<=Gn?new vr(n,e,o.concat(r)):W(t,n,br(e,r))}function Er(t,r,n){this.root=t,this.tail=r,this.tail_size=n,this.hash=null}function xr(t){return t instanceof Er}function Sr(t){return null!=t?t instanceof Er?t:new Er(Qn,Qn,0).concat(t):new Er(Qn,Qn,0)}function kr(t,r){return t===r?0:r>t?-1:1}function zr(t,r,n){for(;t!==Qn;){var e=r(n,t.hash);if(0===e)break;t=0>e?t.left:t.right}return t}function Or(t,r,n,e){if(t===Qn)return e;var o=t.left,i=t.right,u=r(n,t.hash);if(0===u)return t.modify(e);if(0>u){var f=Or(o,r,n,e);return f===o?t:W(t,f,i)}var f=Or(i,r,n,e);return f===i?t:W(t,o,f)}function _r(t,r,n,e,o){if(t===Qn)throw Error("Key "+e+" not found");var i=t.left,u=t.right,f=r(n,t.hash);if(0===f)return t.modify({key:e,hash:n,value:o(t.value)});if(0>f){var a=_r(i,r,n,e,o);return a===i?t:W(t,a,u)}var a=_r(u,r,n,e,o);return a===u?t:W(t,i,a)}function Ar(t,r,n){if(t===Qn)return t;var e=t.left,o=t.right,i=r(n,t.hash);if(0===i)return X(e,o);if(0>i){var u=Ar(e,r,n);return u===e?t:W(t,u,o)}var u=Ar(o,r,n);return u===o?t:W(t,e,u)}function jr(){return this.root===Qn}function Ir(t){return zr(this.root,this.sort,this.hash_fn(t))!==Qn}function Tr(t){return function(r){var n=this.root,e=this.sort,o=this.hash_fn,i=Ar(n,e,o(r));return i===n?this:new t(i,e,o)}}function Cr(t){return S(A(t),this,function(t,r){return en(r,function(r,n){return t.set(r,n)})})}function Dr(){return this.len}function Jr(t){return S(t,this,function(t,r){return t.push(r)})}function Ur(t,r,n,e,o){this.left=t,this.right=r,this.hash=n,this.key=e,this.value=o,this.depth=V(t.depth,r.depth)+1}function Nr(t,r,n){this.root=t,this.sort=r,this.hash_fn=n,this.hash=null}function Rr(t){return t instanceof Nr}function Mr(t){return Rr(t)&&t.hash_fn===rn}function Lr(t,r){return null!=r?Mr(r)&&r.sort===t?r:new Nr(Qn,t,rn).merge(r):new Nr(Qn,t,rn)}function Qr(t){return null!=t?Rr(t)&&!Mr(t)?t:new Nr(Qn,kr,L).merge(t):new Nr(Qn,kr,L)}function Kr(t){if(Array.isArray(t)){for(var r=Sr(),n=0,e=t.length;e>n;++n)r=r.push(Kr(t[n]));return r}if(Yr(t)){var r=Qr();return Object.keys(t).forEach(function(n){r=r.set(Kr(n),Kr(t[n]))}),r}return t}function qr(t){if(Xr(t)){var r=t[Nn];if(null!=r)return r(t);if(Array.isArray(t))return t.map(qr);if(Yr(t)){var n={};return Object.keys(t).forEach(function(r){n[qr(r)]=qr(t[r])}),n}return t}return t}function Fr(t){var r={};return j(t,function(t){en(t,function(t,n){if("string"!=typeof t)throw Error("Cannot convert to JavaScript: expected key to be string or Tag but got "+t);r[t]=qr(n)})}),r}function $r(t){var r=[];return j(t,function(t){r.push(qr(t))}),r}function Pr(t){this.values=t,this.hash=null}function Br(t){return t instanceof Pr}function Gr(t){return new Pr(t)}function Hr(t){if(null!=t){if(Br(t))return t;var r=[];return j(t,function(t){r.push(t)}),new Pr(r)}return new Pr([])}function Vr(t){return t!==t}function Wr(t){return"number"==typeof t&&1/0!==t&&t!==-1/0&&!Vr(t)}function Xr(t){return Object(t)===t}function Yr(t){return Xr(t)&&Object.getPrototypeOf(t)===Object.prototype}function Zr(t,r){return Array(r+1).join(t)}function tn(t,r,n){var e=Math.max(0,r-t.length);return t+Zr(n,e)}function rn(t){return t}function nn(t,r){return 1===t?r:r+"s"}function en(t,r){if(Array.isArray(t)){if(2===t.length)return r(t[0],t[1]);throw Error("Expected array with 2 elements but got "+t.length+" "+nn(t.length,"element"))}if(Br(t)){if(2===t.size())return r(t.get(0),t.get(1));throw Error("Expected Tuple with 2 elements but got "+t.size()+" "+nn(t.size(),"element"))}throw Error("Expected array or Tuple but got: "+t)}function on(t,r,n,e){this.left=t,this.right=r,this.hash=n,this.key=e,this.depth=V(t.depth,r.depth)+1}function un(t,r,n){this.root=t,this.sort=r,this.hash_fn=n,this.hash=null}function fn(t){return t instanceof un}function an(t){return fn(t)&&t.hash_fn===rn}function sn(t,r){return null!=r?an(r)&&r.sort===t?r:new un(Qn,t,rn).union(r):new un(Qn,t,rn)}function hn(t){return null!=t?fn(t)&&!an(t)?t:new un(Qn,kr,L).union(t):new un(Qn,kr,L)}function cn(t,r,n){this.left=t,this.right=r,this.len=n,this.hash=null}function ln(t){return t instanceof cn}function pn(t){return null!=t?t instanceof cn?t:new cn(Qn,Qn,0).concat(t):new cn(Qn,Qn,0)}function vn(t,r){this.root=t,this.len=r,this.hash=null}function yn(t){return t instanceof vn}function gn(t){return null!=t?t instanceof vn?t:new vn(Qn,0).concat(t):new vn(Qn,0)}function dn(t){if("string"!=typeof t)throw Error("Expected key to be a string or Tag but got "+t)}function wn(t,r){this.keys=t,this.values=r,this.hash=null}function mn(t){return t instanceof wn}function bn(t){var r={},n=[];if(null!=t){if(mn(t))return t;var e=J(A(t),function(t){return en(t,function(t,r){return dn(t),[t,r]})}),o=z(e).sort(function(t,r){return kr(t[0],r[0])});j(o,function(t){var e=t[0],o=t[1],i=r[e];null==i?r[e]=n.push(o)-1:n[i]=o})}return new wn(r,n)}function En(t,r){this._id=++Wn,this._value=t,this._onchange=r}function xn(t){return Sn(t)?t.get():t}function Sn(t){return t instanceof En}function kn(t,r){if(arguments.length<1||arguments.length>2)throw Error("Expected 1 to 2 arguments but got "+arguments.length);return new En(t,r)}function zn(t){if(Xr(t))return Object.isFrozen(t)||Rr(t)||fn(t)||xr(t)||Br(t)||ln(t)||yn(t)||mn(t);var r=typeof t;return"string"===r||"number"===r||"boolean"===r||"symbol"===r||null==t}var On="48de6fff-9d11-472d-a76f-ed77a59a5cbc",_n=0,An="[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}",jn=RegExp("^"+An+"$"),In=RegExp("^\\(Tag "+On+" [0-9]+\\)$"),Tn=RegExp("^\\(UUIDTag "+An+"\\)$"),Cn="undefined"!=typeof Symbol&&void 0!==Symbol.iterator?Symbol.iterator:null,Dn="undefined"!=typeof Symbol&&void 0!==Symbol.keyFor?Symbol.keyFor:null,Jn=a("e1c3818d-4c4f-4703-980a-00969e4ca900"),Un=a("6199065c-b518-4cb3-8b41-ab70a9769ec3"),Nn=a("1b75a273-16bd-4248-be8a-e4b5e8c4b523"),Rn=a("89d8297c-d95e-4ce9-bc9b-6b6f73fa6a37"),Mn=a("99e14916-bc99-4c48-81aa-299cf1ad6de3"),Ln={},Qn={};Qn.depth=0,Qn.size=0;var Kn={},qn=0,Fn=0,$n={},Pn={},Bn={};Pn.toString=Bn.toString=rr,Pn.inspect=Bn.inspect=rr,Bn.toJSON=nr,null!==Cn&&(Pn[Cn]=Bn[Cn]=function(){return l(this)});var Gn=125,Hn=Math.ceil,Vn=Math.floor;vr.prototype.copy=function(t,r){return new vr(t,r,this.array)},Er.prototype=Object.create(Bn),Er.prototype[Jn]=K("List"),Er.prototype[Nn]=$r,Er.prototype.has=or,Ln.List=function(t){return Sr(H(t))},Er.prototype[Mn]=function(t){return B("List",t)},Er.prototype[Un]=function(){var t=_(tr(this.root),function(t){return l(t.array)});return g(t,x(ur(this.tail)))},Er.prototype.isEmpty=function(){return this.root===Qn&&this.tail===Qn},Er.prototype.removeAll=function(){return new Er(Qn,Qn,0)},Er.prototype.size=function(){return this.root.size+this.tail_size},Er.prototype.get=function(t,r){var n=this.size();if(0>t&&(t+=n),er(t,n)){var e=this.root,o=e.size;return o>t?yr(e,t):pr(this.tail,this.tail_size,t-o)}if(2===arguments.length)return r;throw Error("Index "+t+" is not valid")},Er.prototype.insert=function(t,n){if(2!==arguments.length)throw Error("Expected 2 arguments but got "+arguments.length);var e=this.size();if(0>t&&(t+=e+1),t===e)return this.push(n);var o=this.root,i=this.tail,u=this.tail_size;if(er(t,e)){var f=o.size;if(f>=t)return new Er(gr(o,t,n),i,u);var a=r(lr(i,u),t-f,n);return new Er(br(o,a),Qn,0)}throw Error("Index "+t+" is not valid")},Er.prototype.push=function(t){var r=this.root,n=this.tail,e=this.tail_size;if(e===Gn){var o=br(r,lr(n,e));return new Er(o,new ir(t,Qn),1)}return new Er(r,new ir(t,n),e+1)},Er.prototype.remove=function(t){if(1!==arguments.length)throw Error("Expected 1 argument but got "+arguments.length);var r=this.size();0>t&&(t+=r);var n=this.root,o=this.tail,i=this.tail_size;if(o!==Qn&&t===r-1)return new Er(n,o.cdr,i-1);if(er(t,r)){var u=n.size;if(u>t)return new Er(wr(n,t),o,i);var f=e(lr(o,i),t-u);return new Er(br(n,f),Qn,0)}throw Error("Index "+t+" is not valid")},Er.prototype.modify=function(t,r){var e=this.size();if(0>t&&(t+=e),er(t,e)){var o=this.root,i=this.tail,u=this.tail_size,f=o.size;if(i!==Qn&&t===e-1){var a=r(i.car);return a===i.car?this:new Er(o,new ir(a,i.cdr),u)}if(f>t){var s=dr(o,t,r);return s===o?this:new Er(s,i,u)}var h=lr(i,u),c=n(h,t-f,r);return c===h?this:new Er(br(o,c),Qn,0)}throw Error("Index "+t+" is not valid")},Er.prototype.set=function(t,r){return this.modify(t,function(){return r})},Er.prototype.slice=function(t,r){var n=this.size();if(arguments.length<1&&(t=0),arguments.length<2&&(r=n),"number"!=typeof t)throw Error("Expected a number but got "+t);if("number"!=typeof r)throw Error("Expected a number but got "+r);if(0>t&&(t+=n),0>r&&(r+=n),0===t&&r===n)return this;if(t>r)throw Error("Index "+t+" is greater than index "+r);if(er(t,n)){if(t===r)return new Er(Qn,Qn,0);if(r>0&&n>=r){var e=this.root,o=e.size,i=[];if(o>=t&&mr(i,e,t,r),r>o){var u=lr(this.tail,this.tail_size);ar(i,cr(u,t-o,r-o))}return new Er(hr(i),Qn,0)}throw Error("Index "+r+" is not valid")}throw Error("Index "+t+" is not valid")},Er.prototype.concat=function(t){if(t instanceof Er){var r=this.root,n=this.tail,e=t.root,o=t.tail;if(e===Qn&&o===Qn)return this;if(r===Qn&&n===Qn)return t;n!==Qn&&(r=br(r,lr(n,this.tail_size)));var i=X(r,e);return new Er(i,o,t.tail_size)}return S(t,this,function(t,r){return t.push(r)})},Ur.prototype.copy=function(t,r){return new Ur(t,r,this.hash,this.key,this.value)},Ur.prototype.modify=function(t){var r=t.hash,n=t.key,e=t.value;return this.hash===r&&this.key===n&&this.value===e?this:new Ur(this.left,this.right,r,n,e)},Nr.prototype=Object.create(Bn),Nr.prototype[Nn]=Fr,Nr.prototype.isEmpty=jr,Nr.prototype.has=Ir,Nr.prototype.remove=Tr(Nr),Nr.prototype.merge=Cr,Nr.prototype[Un]=function(){return y(tr(this.root),function(t){return Gr([t.key,t.value])})},Nr.prototype[Jn]=function(t){return null===t.hash&&(t.hash=Rr(t)&&!Mr(t)?"(Dict"+Q(t,"  ")+")":"(SortedDict "+L(t.sort)+Q(t,"  ")+")"),t.hash},Ln.Dict=function(t){return Qr(G(t))},Nr.prototype[Mn]=function(t){if(Rr(t)&&!Mr(t))return P("Dict",t);throw Error("Cannot convert SortedDict to JSON")},Nr.prototype.removeAll=function(){return new Nr(Qn,this.sort,this.hash_fn)},Nr.prototype.get=function(t,r){var n=zr(this.root,this.sort,this.hash_fn(t));if(n===Qn){if(2===arguments.length)return r;throw Error("Key "+t+" not found")}return n.value},Nr.prototype.set=function(t,r){var n=this.root,e=this.sort,o=this.hash_fn,i=o(t),u=Or(n,e,i,new Ur(Qn,Qn,i,t,r));return u===n?this:new Nr(u,e,o)},Nr.prototype.modify=function(t,r){var n=this.root,e=this.sort,o=this.hash_fn,i=_r(n,e,o(t),t,r);return i===n?this:new Nr(i,e,o)},Pr.prototype=Object.create(Bn),Pr.prototype[Jn]=K("Tuple"),Pr.prototype[Nn]=$r,Ln.Tuple=function(t){return Hr(H(t))},Pr.prototype[Mn]=function(t){return B("Tuple",t)},Pr.prototype[Un]=function(){return l(this.values)},Pr.prototype.size=function(){return this.values.length},Pr.prototype.get=function(t){var r=this.size();if(er(t,r))return this.values[t];throw Error("Index "+t+" is not valid")},Pr.prototype.modify=function(t,r){var e=this.size();if(er(t,e)){var o=this.values,i=n(o,t,r);return i===o?this:new Pr(i)}throw Error("Index "+t+" is not valid")},Pr.prototype.set=function(t,r){return this.modify(t,function(){return r})},on.prototype.copy=function(t,r){return new on(t,r,this.hash,this.key)},on.prototype.modify=function(t){var r=t.hash,n=t.key;return this.hash===r&&this.key===n?this:new on(this.left,this.right,r,n)},un.prototype=Object.create(Bn),un.prototype[Nn]=$r,un.prototype.isEmpty=jr,un.prototype.has=Ir,un.prototype.remove=Tr(un),Ln.Set=function(t){return hn(H(t))},un.prototype[Un]=function(){return y(tr(this.root),function(t){return t.key})},un.prototype[Mn]=function(t){if(fn(t)&&!an(t))return B("Set",t);throw Error("Cannot convert SortedSet to JSON")},un.prototype[Jn]=function(t){if(null===t.hash){var r=J(t,function(t){return L(t)}),n="  ";t.hash=fn(t)&&!an(t)?"(Set"+q(r,n)+")":"(SortedSet "+L(t.sort)+q(r,n)+")"}return t.hash},un.prototype.removeAll=function(){return new un(Qn,this.sort,this.hash_fn)},un.prototype.add=function(t){var r=this.root,n=this.sort,e=this.hash_fn,o=e(t),i=Or(r,n,o,new on(Qn,Qn,o,t));return i===r?this:new un(i,n,e)},un.prototype.union=function(t){return S(t,this,function(t,r){return t.add(r)})},un.prototype.intersect=function(t){var r=this;if(r.isEmpty())return r;var n=r.removeAll();return S(t,n,function(t,n){return r.has(n)?t.add(n):t})},un.prototype.disjoint=function(t){var r=this;return S(t,r,function(t,n){return r.has(n)?t.remove(n):t.add(n)})},un.prototype.subtract=function(t){return this.isEmpty()?this:S(t,this,function(t,r){return t.remove(r)})},cn.prototype=Object.create(Bn),cn.prototype[Nn]=$r,cn.prototype[Jn]=K("Queue"),cn.prototype.size=Dr,cn.prototype.concat=Jr,Ln.Queue=function(t){return pn(H(t))},cn.prototype[Mn]=function(t){return B("Queue",t)},cn.prototype.isEmpty=function(){return this.left===Qn&&this.right===Qn},cn.prototype.removeAll=function(){return new cn(Qn,Qn,0)},cn.prototype[Un]=function(){return g(ur(this.left),x(ur(this.right)))},cn.prototype.peek=function(t){if(this.isEmpty()){if(1===arguments.length)return t;throw Error("Cannot peek from an empty queue")}return this.left.car},cn.prototype.push=function(t){return this.isEmpty()?new cn(new ir(t,this.left),this.right,this.len+1):new cn(this.left,new ir(t,this.right),this.len+1)},cn.prototype.pop=function(){if(this.isEmpty())throw Error("Cannot pop from an empty queue");var t=this.left.cdr;if(t===Qn){var r=Qn;return fr(this.right,function(t){r=new ir(t,r)}),new cn(r,Qn,this.len-1)}return new cn(t,this.right,this.len-1)},vn.prototype=Object.create(Bn),vn.prototype[Nn]=$r,vn.prototype[Jn]=K("Stack"),vn.prototype.isEmpty=jr,vn.prototype.size=Dr,vn.prototype.concat=Jr,Ln.Stack=function(t){return gn(H(t))},vn.prototype[Un]=function(){return x(ur(this.root))},vn.prototype[Mn]=function(t){return B("Stack",t)},vn.prototype.removeAll=function(){return new vn(Qn,0)},vn.prototype.peek=function(t){if(this.isEmpty()){if(1===arguments.length)return t;throw Error("Cannot peek from an empty stack")}return this.root.car},vn.prototype.push=function(t){return new vn(new ir(t,this.root),this.len+1)},vn.prototype.pop=function(){if(this.isEmpty())throw Error("Cannot pop from an empty stack");return new vn(this.root.cdr,this.len-1)},wn.prototype=Object.create(Bn),wn.prototype.update=Cr,wn.prototype[Nn]=Fr,Ln.Record=function(t){return bn(G(t))},wn.prototype[Mn]=function(t){return P("Record",t)},wn.prototype[Jn]=function(t){return null===t.hash&&(t.hash="(Record"+Q(t,"  ")+")"),t.hash},wn.prototype[Un]=function(){var t=this.keys,r=this.values;return l(J(A(t),function(t){return en(t,function(t,n){return Gr([t,r[n]])})}))},wn.prototype.get=function(t){dn(t);var r=this.keys[t];if(null==r)throw Error("Key "+t+" not found");return this.values[r]},wn.prototype.set=function(t,r){return this.modify(t,function(){return r})},wn.prototype.modify=function(t,r){dn(t);var e=this.keys,o=e[t];if(null==o)throw Error("Key "+t+" not found");var i=this.values,u=n(i,o,r);return u===i?this:new wn(e,u)};var Wn=0;En.prototype=Object.create(Pn),En.prototype[Jn]=function(t){return"(Ref "+L(t._id)+")"},En.prototype.get=function(){return this._value},En.prototype.set=function(t){var r=this._value;t!==r&&(this._value=t,null!=this._onchange&&this._onchange(r,t))},En.prototype.modify=function(t){this.set(t(this.get()))},function(t,r){"function"==typeof define&&define.amd?define(["exports"],r):"object"==typeof exports?r(exports):(t.Immutable={},r(t.Immutable))}(this,function(t){t.equal=s,t.fromJS=Kr,t.toJS=qr,t.isDict=Rr,t.isSet=fn,t.isSortedDict=Mr,t.isSortedSet=an,t.isList=xr,t.isQueue=ln,t.isTuple=Br,t.isStack=yn,t.isImmutable=zn,t.SortedDict=Lr,t.SortedSet=sn,t.isIterable=c,t.Dict=Qr,t.Set=hn,t.List=Sr,t.Tuple=Hr,t.Queue=pn,t.Stack=gn,t.simpleSort=kr,t.isRecord=mn,t.Record=bn,t.toJSON=$,t.fromJSON=F,t.deref=xn,t.Ref=kn,t.isRef=Sn,t.isTag=i,t.isUUIDTag=u,t.Tag=f,t.UUIDTag=a,t.each=j,t.map=J,t.keep=N,t.findIndex=I,t.reverse=U,t.foldl=S,t.foldr=k,t.join=O,t.zip=E,t.toArray=z,t.any=d,t.all=w,t.find=m,t.partition=b,t.range=D,t.take=C,t.indexOf=T,t.toIterator=l,t.Iterable=p})}).call(this);